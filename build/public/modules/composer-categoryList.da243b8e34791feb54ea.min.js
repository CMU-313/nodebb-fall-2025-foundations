(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,25764,33069,34271,49897,69185,86198,99127],{13342:(p,w,l)=>{p.exports=l(41644)},14063:(p,w,l)=>{"use strict";p=l.nmd(p);var E,h;E=[l(17459),l(91749)],h=function(k,b){const s={};let c=!1;s.init=function(){if(s.taskbar=$('[component="taskbar"]'),s.tasklist=s.taskbar.find("ul"),!s.taskbar.length||!s.tasklist.length){c=!0;return}s.taskbar.on("click","li",async function(){const e=$(this),n=e.attr("data-module"),r=e.attr("data-uuid"),t=await app.require(n);return e.hasClass("active")?t.minimize(r):(i(),t.load(r),s.toggleNew(r,!1),s.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(e,n){if(c)return;if(s.tasklist.find('[data-module="'+p+'"][data-uuid="'+n+'"]').length){const t=await app.require(e);t&&typeof t.close=="function"&&t.close(n)}},s.closeAll=function(e){if(c)return;let n="[data-uuid]";e&&(n='[data-module="'+e+'"]'+n),s.tasklist.find(n).each(function(r,t){s.close(e||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},s.discard=function(e,n){if(c)return;s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').remove(),f()},s.push=function(e,n,r,t){if(t=t||function(){},c)return t();const o=s.tasklist.find('li[data-uuid="'+n+'"]'),a={module:e,uuid:n,options:r,element:o};b.fire("filter:taskbar.push",a),!o.length&&a.module?d(a,t):t(o)},s.get=function(e){return c?[]:$('[data-module="'+e+'"]').map(function(r,t){return $(t).data()})},s.minimize=function(e,n){if(c)return;s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},s.toggleNew=function(e,n,r){if(c)return;s.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",n),r||b.fire("action:taskbar.toggleNew",e)},s.updateActive=function(e){if(c)return;const n=s.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(e){return c?!1:s.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function f(){if(c)return;s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function i(){c||s.tasklist.find(".active").removeClass("active")}function d(e,n){if(c)return n();k.translate(e.options.title,function(r){const t=$("<div></div>").text(r||"NodeBB Task").html(),o=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&i(),s.tasklist.append(o),f(),e.element=o,o.data(e),b.fire("action:taskbar.pushed",e),n(o)})}const m=function(e,n,r){switch(n){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return s.update=function(e,n,r){if(c)return;const t=s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]');if(!t.length)return;const o=t.data();Object.keys(r).forEach(function(a){o[a]=r[a],m(t,a,r[a])}),t.data(o)},s}.apply(w,E),h!==void 0&&(p.exports=h)},41644:(p,w,l)=>{"use strict";var E,h;E=[l(65348),l(14063),l(49897)],h=function(k,b,s){var c={},f;c.init=function(e,n){var r=e.find(".category-list-container");r.length&&(e.on("action:composer.resize",function(){i(e)}),c.updateTaskbar(e,n),f=k.init(r.find('[component="category-selector"]'),{privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],onSelect:function(t){n.hasOwnProperty("cid")&&m(e,n,t)}}),f&&(n.cid&&n.category?f.selectedCategory={cid:n.cid,name:n.category.name}:ajaxify.data.template.compose&&ajaxify.data.selectedCategory&&(f.selectedCategory={cid:ajaxify.data.cid,name:ajaxify.data.selectedCategory}),e.find(".category-name").translateHtml(f.selectedCategory?f.selectedCategory.name:"[[modules:composer.select-category]]").on("click",function(){k.modal({privilege:"topics:create",states:["watching","tracking","notwatching","ignoring"],openOnLoad:!0,showLinks:!1,onSubmit:function(t){e.find(".category-name").text(t.name),f.selectCategory(t.cid),n.hasOwnProperty("cid")&&m(e,n,t)}})}),i(e)))};function i(e){e.find('.category-list-container [component="category-selector"]').toggleClass("dropup",e.outerHeight()<$(window).height()/2)}c.getSelectedCid=function(){var e;return f&&(e=f.getSelectedCategory()),e?e.cid:0},c.updateTaskbar=function(e,n){parseInt(n.cid,10)&&s.get(`/categories/${n.cid}`,{}).then(function(r){d(e,r)})};function d(e,n){if(n){var r=e.attr("data-uuid");b.update("composer",r,{image:n.backgroundImage,color:n.color,"background-color":n.bgColor,icon:n.icon&&n.icon.slice(3)})}}async function m(e,n,r){n.cid=r.cid;const t=await window.fetch(`${config.relative_path}/api/category/${encodeURIComponent(r.cid)}`).then(o=>o.json());n.category=t,d(e,t),l.e(56382).then(function(){var o=[l(72573),l(52543),l(92762)];(function(a,u,g){a.onChangeCategory(t),u.onChangeCategory(e,n,r.cid,t),g.onChangeCategory(e,n),$(window).trigger("action:composer.changeCategory",{postContainer:e,postData:n,selectedCategory:r,categoryData:t})}).apply(null,o)}).catch(l.oe)}return c}.apply(w,E),h!==void 0&&(p.exports=h)},49897:(p,w,l)=>{"use strict";l.r(w),l.d(w,{del:()=>r,get:()=>i,head:()=>d,patch:()=>e,post:()=>m,put:()=>n});var E=l(91749),h=l.n(E),k=l(33530),b=l.n(k);const s=config.relative_path+"/api/v3";async function c(t,o){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:s+t.url,typeof o=="function"){f(t).then(a=>o(null,a),a=>{let u=a;a instanceof Error||(u=new Error(String(a)));const g=u.message||String(u);if(g&&!g.startsWith("[[error:")&&(g.toLowerCase()==="fetch failed"||g.toLowerCase()==="failed to fetch"||g.toLowerCase().includes("networkerror")||g.toLowerCase().includes("network")&&g.toLowerCase().includes("failed"))){const y=new Error("[[error:no-connection]]");y.originalError=u,u=y}o(u)});return}try{return await f(t)}catch(a){if(a.message==="A valid login session was not found. Please log in and try again."){const{url:u}=await(0,E.fire)("filter:admin.reauth",{url:"login"});return(0,k.confirm)("[[error:api.reauth-required]]",g=>{g&&ajaxify.go(u)})}throw a}}async function f(t){const{url:o}=t;delete t.url,t.headers||(t.headers={}),t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8");try{({options:t}=await(0,E.fire)("filter:api.options",{options:t}))}catch(C){console.error("[API] Error in filter:api.options hook:",C)}t.data&&(t.body=t.data,delete t.data);let a;try{a=await fetch(o,t)}catch(C){const A=C.message||C.toString()||String(C),x=C.name||"Error";if(x==="TypeError"&&(A.toLowerCase().includes("fetch")||A.toLowerCase().includes("network")||A.toLowerCase().includes("failed to fetch")||A.toLowerCase().includes("load failed"))||A.toLowerCase().includes("cors")||A.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:o,method:t.method||"GET",error:A,name:x});const L=new Error("[[error:no-connection]]");throw L.originalError=C,L}throw console.error("[API] Unexpected fetch error:",{url:o,method:t.method||"GET",error:A,name:x}),C}const{headers:u}=a;if(u.get("x-redirect"))return f({url:u.get("x-redirect"),...t});const g=u.get("content-type"),v=g&&g.startsWith("application/json");let y;if(t.method!=="HEAD")try{v?y=await a.json():y=await a.text()}catch(C){throw console.error("[API] Error parsing response:",{url:o,status:a.status,statusText:a.statusText,contentType:g,error:C.message}),new Error("[[error:invalid-json]]")}if(!a.ok){let C;throw y?v&&y.status&&y.status.message?C=y.status.message:typeof y=="string"?C=y:C=a.statusText||"Request failed":C=a.statusText||"Request failed",new Error(C)}return v&&y&&y.hasOwnProperty("status")&&y.hasOwnProperty("response")?y.response:y}function i(t,o,a){return c({url:t+(o&&Object.keys(o).length?"?"+$.param(o):"")},a)}function d(t,o,a){return c({url:t+(o&&Object.keys(o).length?"?"+$.param(o):""),method:"HEAD"},a)}function m(t,o,a){return c({url:t,method:"POST",data:o,headers:{"x-csrf-token":config.csrf_token}},a)}function e(t,o,a){return c({url:t,method:"PATCH",data:o,headers:{"x-csrf-token":config.csrf_token}},a)}function n(t,o,a){return c({url:t,method:"PUT",data:o,headers:{"x-csrf-token":config.csrf_token}},a)}function r(t,o,a){return c({url:t,method:"DELETE",data:o,headers:{"x-csrf-token":config.csrf_token}},a)}},65348:(p,w,l)=>{"use strict";var E,h;E=[l(96349),l(33530),l(91749),l(17459)],h=function(k,b,s,c){const f={};return f.init=function(i,d){if(!i||!i.length)return;d=d||{};const m=d.onSelect||function(){};d.states=d.states||["watching","tracking","notwatching","ignoring"],d.template=d.template||"partials/category/selector-dropdown-left",s.fire("action:category.selector.options",{el:i,options:d}),k.init(i,d);const e={el:i,selectedCategory:null};i.on("click","[data-cid]",function(){const r=$(this);return r.hasClass("disabled")?!1:(e.selectCategory(r.attr("data-cid")),m(e.selectedCategory))});let n=e.el.find('[component="category-selector-selected"]').html();return c.translate(n,r=>{n=r}),e.selectCategory=function(r){const t=e.el.find('[data-cid="'+r+'"]');e.selectedCategory={cid:r,name:t.attr("data-name")},t.length?e.el.find('[component="category-selector-selected"]').html(t.find('[component="category-markup"]').html()):e.el.find('[component="category-selector-selected"]').html(n)},e.getSelectedCategory=function(){return e.selectedCategory},e.getSelectedCid=function(){return e.selectedCategory?e.selectedCategory.cid:0},d.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(d.template,{selectedCategory:d.selectedCategory},function(r){e.el.find('[component="category-selector-selected"]').html(r.find('[component="category-selector-selected"]').html())}),e},f.modal=function(i){i=i||{},i.onSelect=i.onSelect||function(){},i.onSubmit=i.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:i.message},function(d){const m=b.dialog({title:i.title||"[[modules:composer.select-category]]",message:d,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:n}}}),e=f.init(m.find('[component="category-selector"]'),i);function n(r){return r.preventDefault(),e.selectedCategory&&(i.onSubmit(e.selectedCategory),m.modal("hide")),!1}i.openOnLoad&&m.on("shown.bs.modal",function(){m.find(".dropdown-toggle").dropdown("toggle")}),m.find("form").on("submit",n)})},f}.apply(w,E),h!==void 0&&(p.exports=h)},96349:(p,w,l)=>{"use strict";var E,h;E=[l(29930),l(89336),l(49897)],h=function(k,b,s){const c={};return c.init=function(f,i){let d=i.defaultCategories||null;i=i||{},i.privilege=i.privilege||"topics:read",i.states=i.states||["watching","tracking","notwatching","ignoring"],i.cacheList=i.hasOwnProperty("cacheList")?i.cacheList:!0;let m=[];Array.isArray(i.localCategories)&&(m=i.localCategories.map(o=>({...o})),d&&(d=[...m,...d])),i.selectedCids=i.selectedCids||ajaxify.data.selectedCids||[];const e=f.find('[component="category-selector-search"]');if(!e.length)return;const n=e.parents('[component="category/dropdown"]').length>0||e.parents('[component="category-selector"]').length>0;f.on("show.bs.dropdown",function(){n&&e.removeClass("hidden");function o(){const a=e.find("input").val();a.length>1||!a&&!d?r(a,function(u){d=i.cacheList&&(d||u),t(u)}):!a&&d&&t(d)}e.on("click",function(a){a.preventDefault(),a.stopPropagation()}),e.find("input").val("").on("keyup",utils.debounce(o,300)),o()}),f.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||e.find("input").focus()}),f.on("hide.bs.dropdown",function(){n&&e.addClass("hidden"),e.off("click"),e.find("input").off("keyup")});function r(o,a){s.get("/search/categories",{search:o,query:utils.params(),parentCid:i.parentCid||0,selectedCids:i.selectedCids,privilege:i.privilege,states:i.states,showLinks:i.showLinks},function(u,{categories:g}){if(u)return k.error(u);a(m.concat(g))})}function t(o){const a=i.selectedCids.map(String);o.forEach(function(u){u.selected=a.includes(String(u.cid))}),app.parseAndTranslate(i.template,{categoryItems:o.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(u){f.find('[component="category/list"]').html(u.find('[component="category/list"]').html()),f.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!o.length);const g=b.Dropdown.getInstance(f.find(".dropdown-toggle").get(0));g&&g.update()})}},c}.apply(w,E),h!==void 0&&(p.exports=h)}}]);
