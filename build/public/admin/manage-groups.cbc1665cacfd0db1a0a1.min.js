"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[159,1091,26174,34271,49897,99127],{13230:(A,w,c)=>{var l,E,g;(function(h){E=[c(53050)],l=h,g=typeof l=="function"?l.apply(w,E):l,g!==void 0&&(A.exports=g)})(function(h){const y=h("[^\\p{L}\\s\\d\\-_@.]","g"),d=/[^\w\s\d\-_@.]/g,p=/^\s+|\s+$/g,_=/\s+/g,C=/-+/g,k=/-$/g,o=/^-/g,i=/^[\w\d\s.,\-@]+$/;return function(e,t){return e?(e=String(e).replace(p,""),i.test(e)?e=e.replace(d,"-"):e=h.replace(e,y,"-"),e=t?e:e.toLocaleLowerCase(),e=e.replace(_,"-"),e=e.replace(C,"-"),e=e.replace(k,""),e=e.replace(o,""),e):""}})},26231:(A,w,c)=>{var l,E;l=[c(13230),c(49897),c(33530),c(29930)],E=function(g,h,y,d){const p={};p.init=function(){_(),C(),$(".groups-list").on("click","[data-action]",function(){const o=$(this),i=o.attr("data-action"),f=o.parents("tr[data-groupname]").attr("data-groupname");switch(i){case"delete":y.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(e){e&&h.del(`/groups/${g(f)}`,{}).then(ajaxify.refresh).catch(d.error)});break}})};function _(){$("#create").on("click",function(){app.parseAndTranslate("admin/partials/create_group_modal",{}).then(o=>{o.modal("show"),o.on("shown.bs.modal",function(){const i=$("#create-modal"),f=$("#create-group-name"),e=$("#create-modal-go"),t=$("#create-modal-error");f.trigger("focus"),i.on("keypress",function(r){r.key==="Enter"&&e.trigger("click")}),o.on("hidden.bs.modal",function(){o.modal("hide"),i.remove()}),e.on("click",function(){const r={name:f.val(),description:$("#create-group-desc").val(),private:$("#create-group-private").is(":checked")?1:0,hidden:$("#create-group-hidden").is(":checked")?1:0};h.post("/groups",r).then(a=>{t.addClass("hide"),f.val(""),i.on("hidden.bs.modal",function(){ajaxify.go("admin/manage/groups/"+a.name)}),i.modal("hide")}).catch(a=>{utils.hasLanguageKey(a.status.message)||(a.status.message="[[admin/manage/groups:alerts.create-failure]]"),t.translateHtml(a.status.message).removeClass("hide")})})})})})}function C(){const o=$("#group-search");function i(){if(!o.val())return ajaxify.refresh();$(".pagination").addClass("hide"),h.get("/api/groups",{query:o.val(),sort:"date",hideEphemeralGroups:!0,excludeGroups:["registered-users","verified-users","unverified-users"]}).then(k).catch(d.error)}o.on("keyup",utils.debounce(i,200))}function k(o){const i=$(".groups-list");app.parseAndTranslate("admin/manage/groups","groups",{groups:o.groups,categories:ajaxify.data.categories},function(f){i.find("[data-groupname]").remove(),i.find("tbody").append(f)})}return p}.apply(w,l),E!==void 0&&(A.exports=E)},49897:(A,w,c)=>{c.r(w),c.d(w,{del:()=>f,get:()=>_,head:()=>C,patch:()=>o,post:()=>k,put:()=>i});var l=c(91749),E=c.n(l),g=c(33530),h=c.n(g);const y=config.relative_path+"/api/v3";async function d(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:y+e.url,typeof t=="function"){p(e).then(r=>t(null,r),r=>{let a=r;r instanceof Error||(a=new Error(String(r)));const u=a.message||String(a);if(u&&!u.startsWith("[[error:")&&(u.toLowerCase()==="fetch failed"||u.toLowerCase()==="failed to fetch"||u.toLowerCase().includes("networkerror")||u.toLowerCase().includes("network")&&u.toLowerCase().includes("failed"))){const n=new Error("[[error:no-connection]]");n.originalError=a,a=n}t(a)});return}try{return await p(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again."){const{url:a}=await(0,l.fire)("filter:admin.reauth",{url:"login"});return(0,g.confirm)("[[error:api.reauth-required]]",u=>{u&&ajaxify.go(a)})}throw r}}async function p(e){const{url:t}=e;delete e.url,e.headers||(e.headers={}),e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8");try{({options:e}=await(0,l.fire)("filter:api.options",{options:e}))}catch(s){console.error("[API] Error in filter:api.options hook:",s)}e.data&&(e.body=e.data,delete e.data);let r;try{r=await fetch(t,e)}catch(s){const m=s.message||s.toString()||String(s),D=s.name||"Error";if(D==="TypeError"&&(m.toLowerCase().includes("fetch")||m.toLowerCase().includes("network")||m.toLowerCase().includes("failed to fetch")||m.toLowerCase().includes("load failed"))||m.toLowerCase().includes("cors")||m.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:t,method:e.method||"GET",error:m,name:D});const L=new Error("[[error:no-connection]]");throw L.originalError=s,L}throw console.error("[API] Unexpected fetch error:",{url:t,method:e.method||"GET",error:m,name:D}),s}const{headers:a}=r;if(a.get("x-redirect"))return p({url:a.get("x-redirect"),...e});const u=a.get("content-type"),v=u&&u.startsWith("application/json");let n;if(e.method!=="HEAD")try{v?n=await r.json():n=await r.text()}catch(s){throw console.error("[API] Error parsing response:",{url:t,status:r.status,statusText:r.statusText,contentType:u,error:s.message}),new Error("[[error:invalid-json]]")}if(!r.ok){let s;throw n?v&&n.status&&n.status.message?s=n.status.message:typeof n=="string"?s=n:s=r.statusText||"Request failed":s=r.statusText||"Request failed",new Error(s)}return v&&n&&n.hasOwnProperty("status")&&n.hasOwnProperty("response")?n.response:n}function _(e,t,r){return d({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},r)}function C(e,t,r){return d({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"HEAD"},r)}function k(e,t,r){return d({url:e,method:"POST",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function o(e,t,r){return d({url:e,method:"PATCH",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function i(e,t,r){return d({url:e,method:"PUT",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function f(e,t,r){return d({url:e,method:"DELETE",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}}}]);
