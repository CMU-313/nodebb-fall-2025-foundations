"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13201,15794,25432,33069,34271,34590,41427,49897,61861,68326,69749,87212,87549,92717,98813,99127],{10870:(k,C,d)=>{var g,f;g=[d(33530),d(17459),d(68636),d(29930),d(91749)],f=function(h,p,o,l,w){const r={};let v,E;r.show=function(){w.one("action:ajaxify.end",()=>{a(),n(),r.showEmailConfirmWarning()})},r.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(o.getItem("email-confirm-dismiss"),10)===1)return;const t={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{o.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(t.message="[[error:no-email-to-confirm]]",t.clickfn=function(){l.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},l.alert(t)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(t.message=i||"[[error:email-not-confirmed]]",t.clickfn=function(){l.remove("email_confirm"),ajaxify.go("/me/edit/email")},l.alert(t)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(t.message="[[error:email-not-confirmed-email-sent]]",l.alert(t))};function n(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||o.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const t=$(".cookie-consent");t.find("button").on("click",function(){o.setItem("cookieconsent","1"),t.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function a(){const i=utils.params({full:!0});v=i.has("loggedin"),E=i.get("register"),v&&(l.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),E&&(h.alert({message:utils.escapeHTML(decodeURIComponent(E))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const t=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(t?`?${t}`:"")+document.location.hash,!0)}return r.showInvalidSession=function(){h.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},r.showSessionMismatch=function(){h.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},r}.apply(C,g),f!==void 0&&(k.exports=f)},11599:(k,C,d)=>{var g,f;g=[d(52473),d(91749),d(49897)],f=function(h,p,o){const l={};l.prepareDOM=function(){const n=$('[component="chat/dropdown"]');n.on("show.bs.dropdown",a=>{E("loadChatsDropdown",$(a.target).parent().find('[component="chat/list"]'))}),n.each((a,i)=>{const t=$(i).parent().find(".dropdown-menu");t.hasClass("show")&&E("loadChatsDropdown",t.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",w),socket.on("event:chats.receive",w),socket.removeListener("event:chats.typing",r),socket.on("event:chats.typing",r),socket.removeListener("event:chats.roomRename",v),socket.on("event:chats.roomRename",v),socket.on("event:unread.updateChatCount",async function(a){if(a){const[u,A]=await app.require(["chat","forum/chats"]);if(u.isFromBlockedUser(a.fromUid)||u.isLookingAtRoom(a.roomId)||app.user.uid===parseInt(a.fromUid,10))return;A.markChatPageElUnread(a),A.updateTeaser(a.roomId,a.teaser)}let{count:i}=await o.get("/chats/unread");const t=h.get("chat/icon");i=Math.max(0,i),t.toggleClass("fa-comment",i>0).toggleClass("fa-comment-o",i<=0);const c=i>99?"99+":i;h.get("chat/icon").toggleClass("unread-count",i>0).attr("data-content",c),h.get("chat/count").toggleClass("hidden",i<=0).text(c),p.fire("action:chat.updateCount",{count:i})})};function w(n){E("onChatMessageReceived",n)}function r(n){E("onUserTyping",n)}function v(n){E("onRoomRename",n)}async function E(n,a){(await app.require("chat"))[n](a)}return l}.apply(C,g),f!==void 0&&(k.exports=f)},14063:(k,C,d)=>{k=d.nmd(k);var g,f;g=[d(17459),d(91749)],f=function(h,p){const o={};let l=!1;o.init=function(){if(o.taskbar=$('[component="taskbar"]'),o.tasklist=o.taskbar.find("ul"),!o.taskbar.length||!o.tasklist.length){l=!0;return}o.taskbar.on("click","li",async function(){const n=$(this),a=n.attr("data-module"),i=n.attr("data-uuid"),t=await app.require(a);return n.hasClass("active")?t.minimize(i):(r(),t.load(i),o.toggleNew(i,!1),o.tasklist.removeClass("active"),n.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){o.closeAll()})},o.close=async function(n,a){if(l)return;if(o.tasklist.find('[data-module="'+k+'"][data-uuid="'+a+'"]').length){const t=await app.require(n);t&&typeof t.close=="function"&&t.close(a)}},o.closeAll=function(n){if(l)return;let a="[data-uuid]";n&&(a='[data-module="'+n+'"]'+a),o.tasklist.find(a).each(function(i,t){o.close(n||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},o.discard=function(n,a){if(l)return;o.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]').remove(),w()},o.push=function(n,a,i,t){if(t=t||function(){},l)return t();const c=o.tasklist.find('li[data-uuid="'+a+'"]'),u={module:n,uuid:a,options:i,element:c};p.fire("filter:taskbar.push",u),!c.length&&u.module?v(u,t):t(c)},o.get=function(n){return l?[]:$('[data-module="'+n+'"]').map(function(i,t){return $(t).data()})},o.minimize=function(n,a){if(l)return;o.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]').toggleClass("active",!1)},o.toggleNew=function(n,a,i){if(l)return;o.tasklist.find('[data-uuid="'+n+'"]').toggleClass("new",a),i||p.fire("action:taskbar.toggleNew",n)},o.updateActive=function(n){if(l)return;const a=o.tasklist.find("li");a.removeClass("active"),a.filter('[data-uuid="'+n+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+n+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},o.isActive=function(n){return l?!1:o.tasklist.find('li[data-uuid="'+n+'"]').hasClass("active")};function w(){if(l)return;o.tasklist.find("li").length>0?o.taskbar.attr("data-active","1"):o.taskbar.removeAttr("data-active")}function r(){l||o.tasklist.find(".active").removeClass("active")}function v(n,a){if(l)return a();h.translate(n.options.title,function(i){const t=$("<div></div>").text(i||"NodeBB Task").html(),c=$("<li></li>").addClass(n.options.className).html('<a href="#"'+(n.options.image?` style="background-image: url('`+n.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(n.options.icon?'<i class="fa '+n.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":n.module,"data-uuid":n.uuid}).addClass(n.options.state!==void 0?n.options.state:"active");(!n.options.state||n.options.state==="active")&&r(),o.tasklist.append(c),w(),n.element=c,c.data(n),p.fire("action:taskbar.pushed",n),a(c)})}const E=function(n,a,i){switch(a){case"title":n.find('[component="taskbar/title"]').text(i);break;case"icon":n.find("i").attr("class","fa fa-"+i);break;case"image":n.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":n.find("a").css("background-color",i);break;case"color":n.find("a").css("color",i);break}};return o.update=function(n,a,i){if(l)return;const t=o.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]');if(!t.length)return;const c=t.data();Object.keys(i).forEach(function(u){c[u]=i[u],E(t,u,i[u])}),t.data(c)},o}.apply(C,g),f!==void 0&&(k.exports=f)},19046:(k,C,d)=>{var g,f;g=[d(91749)],f=function(h){const p={},o={ignoring:1,notwatching:2,watching:3};p.initUnreadTopics=function(){const r=app.user.unreadData;function v(a){if(a&&a.posts&&a.posts.length&&r){const i=a.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==o.watching)return;const t=i.topic.tid;(!r[""][t]||!r.new[t]||!r.watched[t]||!r.unreplied[t])&&n(t),r[""][t]||(E(""),r[""][t]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!r.new[t]&&(E("new"),r.new[t]=!0),parseInt(i.topic.postcount,10)<=1&&!r.unreplied[t]&&(E("unreplied"),r.unreplied[t]=!0),i.topic.isFollowing&&!r.watched[t]&&(E("watched"),r.watched[t]=!0)}}function E(a){const i="/unread"+(a?"?filter="+a:""),t=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);w(i,t)}function n(a){$('[data-tid="'+a+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(a){delete r[a][ajaxify.data.tid]})}),socket.removeListener("event:new_post",v),socket.on("event:new_post",v),socket.removeListener("event:unread.updateCount",l),socket.on("event:unread.updateCount",l)};function l(r){w("/unread",r.unreadTopicCount),w("/unread?filter=new",r.unreadNewTopicCount),w("/unread?filter=watched",r.unreadWatchedTopicCount),w("/unread?filter=unreplied",r.unreadUnrepliedTopicCount)}function w(r,v){if(!utils.isNumber(v))return;v=Math.max(0,v);const E=v>99?"99+":v,n=$('a[href="'+config.relative_path+r+'"].navigation-link');n.find("i").toggleClass("unread-count",v>0).attr("data-content",E),n.find('[component="navigation/count"]').toggleClass("hidden",v<=0).text(v),n.length&&($('#mobile-menu [data-unread-url="'+r+'"]').attr("data-content",E),$('[component="unread/count"][data-unread-url="'+r+'"]').toggleClass("hidden",v<=0).text(E)),h.fire("action:unread.updateCount",{url:r,count:v})}return p.updateUnreadTopicCount=w,p}.apply(C,g),f!==void 0&&(k.exports=f)},25967:(k,C,d)=>{var g,f;g=[d(33530)],f=function(h){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return h.prompt("[[global:enter-page-number]]",function(o){p.loadPage(o)}),!1})},p.loadPage=function(o,l){if(l=l||function(){},o=parseInt(o,10),!utils.isNumber(o)||o<1||o>ajaxify.data.pagination.pageCount)return;const w=utils.params();w.page=o;const r=window.location.pathname+"?"+$.param(w);ajaxify.go(r,l)},p.nextPage=function(o){p.loadPage(ajaxify.data.pagination.currentPage+1,o)},p.previousPage=function(o){p.loadPage(ajaxify.data.pagination.currentPage-1,o)},p}.apply(C,g),f!==void 0&&(k.exports=f)},29869:k=>{k.exports=function(C,d,g){d.setGlobal("true",!0),d.setGlobal("false",!1);const f=24*60*60*1e3,h={displayMenuItem:o,buildMetaTag:l,buildLinkTag:w,stringify:r,escape:v,stripTags:E,buildCategoryIcon:n,buildCategoryLabel:a,generateCategoryBackground:i,generateChildrenCategories:t,generateTopicClass:c,membershipBtn:u,spawnPrivilegeStates:A,localeToHTML:b,renderTopicImage:P,renderDigestAvatar:x,userAgentIcons:y,buildAvatar:_,increment:I,generateWroteReplied:D,generateRepliedTo:R,generateWrote:O,encodeURIComponent:B,isoTimeToLocaleString:j,shouldHideReplyContainer:K,humanReadableNumber:q,formattedNumber:H,txEscape:z,generatePlaceholderWave:Y,register:G,__escape:p};function p(e){return e}function o(e,s){const m=e.navigation[s];return!(!m||m.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||m.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||m.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function l(e){const s=e.name?'name="'+e.name+'" ':"",m=e.property?'property="'+e.property+'" ':"",S=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+s+m+S+`/>
	`}function w(e){const s=["link","rel","as","type","href","sizes","title","crossorigin"],[m,S,L,T,N,F,U,W]=s.map(M=>e[M]?`${M}="${e[M]}" `:"");return"<link "+m+S+L+T+F+U+N+W+`/>
	`}function r(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function v(e){return C.escapeHTML(e)}function E(e){return C.stripHTMLTags(e)}function n(e,s,m){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${m}" style="${i(e)} width:${s}; height: ${s}; font-size: ${parseInt(s,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function a(e,s="a",m=""){if(!e)return"";const S=s==="a"?`href="${g}/category/${e.slug}"`:"";return`<${s} ${S} class="badge px-1 text-truncate text-decoration-none ${m}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${s}>`}function i(e){if(!e)return"";const s=[];return e.bgColor&&(s.push("background-color: "+e.bgColor),s.push(`border-color: ${e.bgColor}!important`)),e.color&&s.push("color: "+e.color),e.backgroundImage&&(s.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&s.push("background-size: "+e.imageClass)),s.join("; ")+";"}function t(e){let s="";return!e||!e.children||!e.children.length||(e.children.forEach(function(m){if(m&&!m.isSection){const S=m.link?m.link:g+"/category/"+m.slug;s+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+i(m)+'"><i class="fa fa-fw '+m.icon+'"></i></div><a href="'+S+'"><small>'+m.name+"</small></a></span>"}}),s=s&&'<span class="category-children">'+s+"</span>"),s}function c(e){return["locked","pinned","deleted","unread","scheduled"].filter(m=>!!e[m]).join(" ")}function u(e,s=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${s}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${s}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${s}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function A(e,s,m,S){const L=[];for(const[T,N]of Object.entries(m))L.push({name:T,state:N,type:S[T]});return L.map(function(T){const N=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],F=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],U=["groups:moderate"];let W=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];e===-1&&(W=W.slice(3));const M=s==="guests"&&(N.includes(T.name)||T.name.startsWith("groups:admin:"))||s==="spiders"&&!F.includes(T.name)||s==="fediverse"&&!W.includes(T.name)||s==="Global Moderators"&&U.includes(T.name);return`
				<td data-privilege="${T.name}" data-value="${T.state}" data-type="${T.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${M?' d-none"':""}" autocomplete="off" type="checkbox"${T.state?" checked":""}${M?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function b(e,s){return e=e||s||"en-GB",e.replace("_","-")}function P(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.displayname+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.displayname+'" />'}function x(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function y(e){let s="";switch(e.platform){case"Linux":s+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":s+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":s+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":s+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":s+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":s+='<i class="fa fa-fw fa-mobile"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":s+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":s+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":s+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":s+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":s+='<i class="fa fa-fw fa-edge"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}return s}function _(e,s,m,S,L){e||(e=this),S=S||"";const T=new Map([["title",e.displayname],["data-uid",e.uid],["class",`avatar ${S}${m?" avatar-rounded":""}`]]),N=[`--avatar-size: ${s};`],F=W=>Array.from(W).reduce((M,[J,Q])=>(M+=` ${J}="${Q}"`,M),"");let U="";return e.picture&&(U+=`<img${F(T)} alt="${e.displayname}" loading="lazy" component="${L||"avatar/picture"}" src="${e.picture}" style="${N.join(" ")}" onError="this.remove()" itemprop="image" />`),U+=`<span${F(T)} component="${L||"avatar/icon"}" style="${N.join(" ")} background-color: ${e["icon:bgColor"]}">${e["icon:text"]}</span>`,U}function I(e,s){return String(e+parseInt(s,10))}function D(e,s){return e.toPid?R(e,s):O(e,s)}function R(e,s){const m=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-s*f?"on":"ago"}, ${e.toPid}, ${g}/post/${encodeURIComponent(e.toPid)}, ${m}, ${g}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function O(e,s){return`[[topic:wrote-${e.timestamp<Date.now()-s*f?"on":"ago"}, ${g}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function B(e){return encodeURIComponent(e)}function j(e,s="en-GB"){return new Date(e).toLocaleString([s],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function K(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function q(e,s=1){return C.makeNumberHumanReadable(e,s)}function H(e){return C.addCommas(e)}function z(e){return String(e).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function Y(e){return e.map(m=>m==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${m}"></div>
			</li>`).join("")}function G(){Object.keys(h).forEach(function(e){d.registerHelper(e,h[e])})}return h}},30076:(k,C,d)=>{var g,f;const h=d(29869);g=[d(77918),d(81335)],f=function(p,o){return h(p,o,config.relative_path)}.apply(C,g),f!==void 0&&(k.exports=f)},49897:(k,C,d)=>{d.r(C),d.d(C,{del:()=>i,get:()=>r,head:()=>v,patch:()=>n,post:()=>E,put:()=>a});var g=d(91749),f=d.n(g),h=d(33530),p=d.n(h);const o=config.relative_path+"/api/v3";async function l(t,c){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:o+t.url,typeof c=="function"){w(t).then(u=>c(null,u),u=>{let A=u;u instanceof Error||(A=new Error(String(u)));const b=A.message||String(A);if(b&&!b.startsWith("[[error:")&&(b.toLowerCase()==="fetch failed"||b.toLowerCase()==="failed to fetch"||b.toLowerCase().includes("networkerror")||b.toLowerCase().includes("network")&&b.toLowerCase().includes("failed"))){const x=new Error("[[error:no-connection]]");x.originalError=A,A=x}c(A)});return}try{return await w(t)}catch(u){if(u.message==="A valid login session was not found. Please log in and try again."){const{url:A}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",b=>{b&&ajaxify.go(A)})}throw u}}async function w(t){const{url:c}=t;delete t.url,t.headers||(t.headers={}),t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8");try{({options:t}=await(0,g.fire)("filter:api.options",{options:t}))}catch(y){console.error("[API] Error in filter:api.options hook:",y)}t.data&&(t.body=t.data,delete t.data);let u;try{u=await fetch(c,t)}catch(y){const _=y.message||y.toString()||String(y),I=y.name||"Error";if(I==="TypeError"&&(_.toLowerCase().includes("fetch")||_.toLowerCase().includes("network")||_.toLowerCase().includes("failed to fetch")||_.toLowerCase().includes("load failed"))||_.toLowerCase().includes("cors")||_.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:c,method:t.method||"GET",error:_,name:I});const R=new Error("[[error:no-connection]]");throw R.originalError=y,R}throw console.error("[API] Unexpected fetch error:",{url:c,method:t.method||"GET",error:_,name:I}),y}const{headers:A}=u;if(A.get("x-redirect"))return w({url:A.get("x-redirect"),...t});const b=A.get("content-type"),P=b&&b.startsWith("application/json");let x;if(t.method!=="HEAD")try{P?x=await u.json():x=await u.text()}catch(y){throw console.error("[API] Error parsing response:",{url:c,status:u.status,statusText:u.statusText,contentType:b,error:y.message}),new Error("[[error:invalid-json]]")}if(!u.ok){let y;throw x?P&&x.status&&x.status.message?y=x.status.message:typeof x=="string"?y=x:y=u.statusText||"Request failed":y=u.statusText||"Request failed",new Error(y)}return P&&x&&x.hasOwnProperty("status")&&x.hasOwnProperty("response")?x.response:x}function r(t,c,u){return l({url:t+(c&&Object.keys(c).length?"?"+$.param(c):"")},u)}function v(t,c,u){return l({url:t+(c&&Object.keys(c).length?"?"+$.param(c):""),method:"HEAD"},u)}function E(t,c,u){return l({url:t,method:"POST",data:c,headers:{"x-csrf-token":config.csrf_token}},u)}function n(t,c,u){return l({url:t,method:"PATCH",data:c,headers:{"x-csrf-token":config.csrf_token}},u)}function a(t,c,u){return l({url:t,method:"PUT",data:c,headers:{"x-csrf-token":config.csrf_token}},u)}function i(t,c,u){return l({url:t,method:"DELETE",data:c,headers:{"x-csrf-token":config.csrf_token}},u)}},68636:(k,C,d)=>{var g;g=function(){function f(){this._store={},this._keys=[]}f.prototype.isMock=!0,f.prototype.setItem=function(o,l){o=String(o),this._keys.indexOf(o)===-1&&this._keys.push(o),this._store[o]=l},f.prototype.getItem=function(o){return o=String(o),this._keys.indexOf(o)===-1?null:this._store[o]},f.prototype.removeItem=function(o){o=String(o),this._keys=this._keys.filter(function(l){return l!==o}),this._store[o]=null},f.prototype.clear=function(){this._keys=[],this._store={}},f.prototype.key=function(o){return o=parseInt(o,10)||0,this._keys[o]},Object.defineProperty&&Object.defineProperty(f.prototype,"length",{get:function(){return this._keys.length}});let h;const p=Date.now().toString();try{if(h=window.localStorage,h.setItem(p,p),h.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return h.removeItem(p),h}catch(o){console.warn(o),console.warn("localStorage failed, falling back on sessionStorage");try{if(h=window.sessionStorage,h.setItem(p,p),h.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return h.removeItem(p),h}catch(l){return console.warn(l),console.warn("sessionStorage failed, falling back on memory storage"),new f}}}.call(C,d,C,k),g!==void 0&&(k.exports=g)},69749:(k,C,d)=>{var g,f;g=[d(17459),d(68636),d(91749),d(29930),d(89336)],f=function(h,p,o,l,w){const r={current:{}};r.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,t)=>{v($(t),n)})};function v(n,a){const i=n.find('[component="search/button"]'),t=n.find('[component="search/fields"]'),c=t.find('input[name="query"]'),u=t.find("#quick-search-container"),A=t.hasClass("hidden"),b=/^(@|acct:)?[\w-]+@.+$/;A&&t.off("focusout").on("focusout",function(){setTimeout(function(){t.find(":focus").length||(t.addClass("hidden"),i.removeClass("hidden"))},200)}),c.off("focus");const P={inputEl:c,resultEl:u};r.enableQuickSearch({searchOptions:a,searchElements:P}),i.off("click").on("click",function(x){return!config.loggedIn&&!app.user.privileges["search:content"]?(l.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(x.stopPropagation(),r.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const x=$(this).find('input[name="query"]'),y=r.getSearchPreferences();return y.term=x.val(),y.in=a.in,b.test(y.term)&&(y.in="users"),o.fire("action:search.submit",{searchOptions:y,searchElements:P}),r.query(y,function(){x.val(""),c.trigger("blur")}),!1})}r.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const a=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,t=n.searchElements.inputEl;let c=t.val();const u=i.find(".filter-category");function A(){ajaxify.data.template.category&&ajaxify.data.cid&&h.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(I){const D=$("<div></div>").html(I).text();u.find(".name").text(D)}),u.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function b(){n.searchOptions=Object.assign({},a),n.searchOptions.term=t.val(),A(),ajaxify.data.template.category&&ajaxify.data.cid&&u.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),o.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,r.api(n.searchOptions,function(I){if(i.find(".loading-indicator").addClass("hidden"),n.searchOptions.in==="categories"){if(!I.categories||n.hideOnNoMatches&&!I.categories.length)return i.addClass("hidden").find(".quick-search-results-container").html("");I.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-category-search-results",I,D=>{D.length&&D.find(".timeago").timeago(),i.toggleClass("hidden",!D.length||!t.is(":focus")).find(".quick-search-results-container").html(D.length?D:""),o.fire("action:search.quick.complete",{data:I,options:n})})}else{if(!I.posts||n.hideOnNoMatches&&!I.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");I.posts.forEach(function(D){const R=$("<div>"+D.content+"</div>").text(),O=t.val().toLowerCase().replace(/^in:topic-\d+/,""),B=Math.max(0,R.toLowerCase().indexOf(O)-40);D.snippet=utils.escapeHTML((B>0?"...":"")+R.slice(B,B+80)+(R.length-B>80?"...":""))}),I.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-search-results",I,function(D){D.length&&D.find(".timeago").timeago(),i.toggleClass("hidden",!D.length||!t.is(":focus")).find(".quick-search-results-container").html(D.length?D:"");const R=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");r.highlightMatches(n.searchOptions.term,R),o.fire("action:search.quick.complete",{data:I,options:n})})}})}i.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),b()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){i.addClass("hidden"),c=t.val();return}if(t.val()!==c){if(c=t.val(),!t.is(":focus"))return i.addClass("hidden");b()}},500)),i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")})});const P=t.parent(),x=i.parent();P.on("focusout",y),x.on("focusout",y);function y(){setTimeout(function(){!P.find(":focus").length&&!x.find(":focus").length&&!i.hasClass("hidden")&&i.addClass("hidden")},200)}let _=!1;o.on("action:ajaxify.end",function(){ajaxify.isCold()||(_=!0),i.addClass("hidden")}),t.on("focus",function(){const I=t.val();c=I,I&&i.find("#quick-search-results").children().length&&(A(),_?(b(),_=!1):i.removeClass("hidden"),t[0].setSelectionRange(I.startsWith("in:topic")?I.indexOf(" ")+1:0,I.length))}),t.off("refresh").on("refresh",function(){b()})},r.showAndFocusInput=function(n){const a=n.parents(".dropdown-menu");if(a.length){const i=a.siblings("[data-bs-toggle]"),t=w.Dropdown.getOrCreateInstance(i[0]);t&&t.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},r.query=function(n,a){a=a||function(){},ajaxify.go("search?"+E(n),a)},r.api=function(n,a){const i=config.relative_path+"/api/search?"+E(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const t=config.relative_path+"/search?"+E(n);$.get(i,function(c){c.url=t,a(c)})};function E(n){const a=n.in||"titles",i=n.term.replace(/^[ ?#]*/,""),t={...n,term:i,in:a};return o.fire("action:search.createQueryString",{query:t,data:n}),$.param(t)}return r.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch(n){return console.error(n),{}}},r.highlightMatches=function(n,a){if(!n||!a.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(c=>c.length>1).map(function(c){return utils.escapeRegexChars(c)}).join("|"),t=new RegExp("("+i+")","gi");a.each(function(){const c=$(this),u=[];c.find("*").each(function(){$(this).after("<!-- "+u.length+" -->"),u.push($("<div></div>").append($(this)))}),c.html(c.html().replace(t,function(A,b){return'<strong class="search-match fw-bold text-decoration-underline">'+b+"</strong>"})),u.forEach(function(A,b){c.html(c.html().replace("<!-- "+b+" -->",function(){return A.html()}))})}),$(".search-results .content").find("img:not(.not-responsive)").addClass("img-fluid")},r}.apply(C,g),f!==void 0&&(k.exports=f)},71949:(k,C,d)=>{var g;g=function(){const f={};f.prepareDOM=function(){const o=$('[component="notifications"] [data-bs-toggle="dropdown"]');o.on("show.bs.dropdown",async l=>{const w=await app.require("notifications"),r=$(l.target);w.loadNotifications(r,r.parent().find('[component="notifications/list"]'))}),o.each((l,w)=>{const r=$(w),v=r.parent().find(".dropdown-menu");v.hasClass("show")&&app.require("notifications").then(E=>{E.loadNotifications(r,v.find('[component="notifications/list"]'))})}),socket.removeListener("event:new_notification",h),socket.on("event:new_notification",h),socket.removeListener("event:notifications.updateCount",p),socket.on("event:notifications.updateCount",p)};async function h(o){(await app.require("notifications")).onNewNotification(o)}async function p(o){(await app.require("notifications")).updateNotifCount(o)}return f}.call(C,d,C,k),g!==void 0&&(k.exports=g)},86174:(k,C,d)=>{var g,f;g=[d(19046),d(71949),d(11599),d(29930)],f=function(h,p,o,l){const w={};w.prepareDOM=function(){app.user.uid>0&&h.initUnreadTopics(),p.prepareDOM(),o.prepareDOM(),r(),v(),E()};function r(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(n){const a=$(this).attr("data-status");socket.emit("user.setStatus",a,function(i){if(i)return l.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(a),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===a)}),app.user.status=a}),n.preventDefault()})}function v(){const n=utils.findBootstrapEnvironment();if(n==="xs"||n==="sm"||utils.isTouchDevice())return;const a=$("#header-menu .nav-item[title]");a.tooltip({trigger:"manual",animation:!1,placement:"bottom"}),a.on("mouseenter",function(i){const t=$(i.target);t.hasClass("dropdown-menu")||!!t.parents(".dropdown-menu").length||$(this).tooltip("show")}),a.on("click mouseleave",function(){$(this).tooltip("hide")})}function E(){$("body").on("click",'[component="user/logout"]',function(){return d.e(20739).then(function(){var n=[d(75427)];(function(a){a()}).apply(null,n)}).catch(d.oe),!1})}return w}.apply(C,g),f!==void 0&&(k.exports=f)}}]);
