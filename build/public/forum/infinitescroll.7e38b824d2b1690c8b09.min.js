"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,49897,82858,99127],{22410:(v,T,f)=>{var m,y;m=[f(91749),f(29930),f(49897)],y=function(p,k,P){const i={};let u,g=0,c=!1,w,E=0;i.init=function(e,t){const r=$("body");typeof e=="function"?(u=e,w=r):(u=t,w=e||r),g=$(window).scrollTop(),$(window).off("scroll",C).on("scroll",C),r.height()<=$(window).height()&&(!ajaxify.data.hasOwnProperty("pageCount")||ajaxify.data.pageCount>1)&&u(1)};function C(){E&&clearTimeout(E),E=setTimeout(function(){E=0,x()},60)}function x(){const e=utils.findBootstrapEnvironment(),t=(e==="xs"||e==="sm")&&$("html").hasClass("composing");if(c||t||app.flags._glance)return;const r=$(window).scrollTop(),o=$(window).height(),n=w.height()-o,l=w.offset()?w.offset().top:0,s=100*(r-l)/(n<=0?o:n),a=15,d=85,h=r>g?1:-1;(s<a&&r<g||s>d&&r>g||s<0&&h>0&&n<0)&&u(h),g=r}return i.loadMore=function(e,t,r){if(c)return;c=!0;const o={method:e,data:t};p.fire("action:infinitescroll.loadmore",o),(o.method.startsWith("/")?P.get:socket.emit)(o.method,o.data,function(l,s){if(l)return c=!1,k.error(l);r(s,function(){c=!1})})},i.loadMoreXhr=function(e,t){if(c)return;c=!0;const r=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),o={url:r,data:e};p.fire("action:infinitescroll.loadmore.xhr",o),$.get(r,e,function(n){t(n,function(){c=!1})}).fail(function(n){c=!1,k.error(String(n.responseJSON||"[[error:no-connection]]"))})},i.removeExtra=function(e,t,r){let o=$();if(e.length<=r)return o;const n=e.length-r;if(t>0){const l=$(document).height(),s=$(window).scrollTop();o=e.slice(0,n).remove(),$(window).scrollTop(s+($(document).height()-l))}else o=e.slice(e.length-n).remove();return o},i}.apply(T,m),y!==void 0&&(v.exports=y)},49897:(v,T,f)=>{f.r(T),f.d(T,{del:()=>x,get:()=>g,head:()=>c,patch:()=>E,post:()=>w,put:()=>C});var m=f(91749),y=f.n(m),p=f(33530),k=f.n(p);const P=config.relative_path+"/api/v3";async function i(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:P+e.url,typeof t=="function"){u(e).then(r=>t(null,r),r=>{let o=r;r instanceof Error||(o=new Error(String(r)));const n=o.message||String(o);if(n&&!n.startsWith("[[error:")&&(n.toLowerCase()==="fetch failed"||n.toLowerCase()==="failed to fetch"||n.toLowerCase().includes("networkerror")||n.toLowerCase().includes("network")&&n.toLowerCase().includes("failed"))){const s=new Error("[[error:no-connection]]");s.originalError=o,o=s}t(o)});return}try{return await u(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again."){const{url:o}=await(0,m.fire)("filter:admin.reauth",{url:"login"});return(0,p.confirm)("[[error:api.reauth-required]]",n=>{n&&ajaxify.go(o)})}throw r}}async function u(e){const{url:t}=e;delete e.url,e.headers||(e.headers={}),e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8");try{({options:e}=await(0,m.fire)("filter:api.options",{options:e}))}catch(a){console.error("[API] Error in filter:api.options hook:",a)}e.data&&(e.body=e.data,delete e.data);let r;try{r=await fetch(t,e)}catch(a){const d=a.message||a.toString()||String(a),h=a.name||"Error";if(h==="TypeError"&&(d.toLowerCase().includes("fetch")||d.toLowerCase().includes("network")||d.toLowerCase().includes("failed to fetch")||d.toLowerCase().includes("load failed"))||d.toLowerCase().includes("cors")||d.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:t,method:e.method||"GET",error:d,name:h});const A=new Error("[[error:no-connection]]");throw A.originalError=a,A}throw console.error("[API] Unexpected fetch error:",{url:t,method:e.method||"GET",error:d,name:h}),a}const{headers:o}=r;if(o.get("x-redirect"))return u({url:o.get("x-redirect"),...e});const n=o.get("content-type"),l=n&&n.startsWith("application/json");let s;if(e.method!=="HEAD")try{l?s=await r.json():s=await r.text()}catch(a){throw console.error("[API] Error parsing response:",{url:t,status:r.status,statusText:r.statusText,contentType:n,error:a.message}),new Error("[[error:invalid-json]]")}if(!r.ok){let a;throw s?l&&s.status&&s.status.message?a=s.status.message:typeof s=="string"?a=s:a=r.statusText||"Request failed":a=r.statusText||"Request failed",new Error(a)}return l&&s&&s.hasOwnProperty("status")&&s.hasOwnProperty("response")?s.response:s}function g(e,t,r){return i({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},r)}function c(e,t,r){return i({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"HEAD"},r)}function w(e,t,r){return i({url:e,method:"POST",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function E(e,t,r){return i({url:e,method:"PATCH",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function C(e,t,r){return i({url:e,method:"PUT",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function x(e,t,r){return i({url:e,method:"DELETE",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}}}]);
