"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,49897,93806,99127],{49897:(P,C,f)=>{f.r(C),f.d(C,{del:()=>y,get:()=>a,head:()=>s,patch:()=>h,post:()=>c,put:()=>g});var E=f(91749),p=f.n(E),b=f(33530),v=f.n(b);const w=config.relative_path+"/api/v3";async function d(e,r){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:w+e.url,typeof r=="function"){l(e).then(t=>r(null,t),t=>{let u=t;t instanceof Error||(u=new Error(String(t)));const i=u.message||String(u);if(i&&!i.startsWith("[[error:")&&(i.toLowerCase()==="fetch failed"||i.toLowerCase()==="failed to fetch"||i.toLowerCase().includes("networkerror")||i.toLowerCase().includes("network")&&i.toLowerCase().includes("failed"))){const o=new Error("[[error:no-connection]]");o.originalError=u,u=o}r(u)});return}try{return await l(e)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again."){const{url:u}=await(0,E.fire)("filter:admin.reauth",{url:"login"});return(0,b.confirm)("[[error:api.reauth-required]]",i=>{i&&ajaxify.go(u)})}throw t}}async function l(e){const{url:r}=e;delete e.url,e.headers||(e.headers={}),e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8");try{({options:e}=await(0,E.fire)("filter:api.options",{options:e}))}catch(n){console.error("[API] Error in filter:api.options hook:",n)}e.data&&(e.body=e.data,delete e.data);let t;try{t=await fetch(r,e)}catch(n){const m=n.message||n.toString()||String(n),k=n.name||"Error";if(k==="TypeError"&&(m.toLowerCase().includes("fetch")||m.toLowerCase().includes("network")||m.toLowerCase().includes("failed to fetch")||m.toLowerCase().includes("load failed"))||m.toLowerCase().includes("cors")||m.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:r,method:e.method||"GET",error:m,name:k});const D=new Error("[[error:no-connection]]");throw D.originalError=n,D}throw console.error("[API] Unexpected fetch error:",{url:r,method:e.method||"GET",error:m,name:k}),n}const{headers:u}=t;if(u.get("x-redirect"))return l({url:u.get("x-redirect"),...e});const i=u.get("content-type"),x=i&&i.startsWith("application/json");let o;if(e.method!=="HEAD")try{x?o=await t.json():o=await t.text()}catch(n){throw console.error("[API] Error parsing response:",{url:r,status:t.status,statusText:t.statusText,contentType:i,error:n.message}),new Error("[[error:invalid-json]]")}if(!t.ok){let n;throw o?x&&o.status&&o.status.message?n=o.status.message:typeof o=="string"?n=o:n=t.statusText||"Request failed":n=t.statusText||"Request failed",new Error(n)}return x&&o&&o.hasOwnProperty("status")&&o.hasOwnProperty("response")?o.response:o}function a(e,r,t){return d({url:e+(r&&Object.keys(r).length?"?"+$.param(r):"")},t)}function s(e,r,t){return d({url:e+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"HEAD"},t)}function c(e,r,t){return d({url:e,method:"POST",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function h(e,r,t){return d({url:e,method:"PATCH",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function g(e,r,t){return d({url:e,method:"PUT",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}function y(e,r,t){return d({url:e,method:"DELETE",data:r,headers:{"x-csrf-token":config.csrf_token}},t)}},78048:(P,C,f)=>{var E,p;E=[f(33530),f(49897),f(29930),f(17459)],p=function(b,v,w,d){const l={};return l.init=function(){$(document).on("click",".edit-category-btn",function(a){a.preventDefault(),a.stopPropagation();const s=$(this),c=s.data("cid"),h=s.data("name")||"";l.showEditModal(c,h)})},l.showEditModal=function(a,s){b.dialog({title:"Edit Category",message:`
				<form id="edit-category-form">
					<div class="mb-3">
						<label for="category-name" class="form-label">Category Name</label>
						<input type="text" class="form-control" id="category-name" name="name" value="${d.escape(s)}" required>
					</div>
				</form>
			`,buttons:{cancel:{label:"Cancel",className:"btn-secondary"},save:{label:"Save Changes",className:"btn-primary",callback:function(){const c=document.getElementById("edit-category-form"),g=new FormData(c).get("name"),y=l.validateCategoryName(g);if(y)return w.alert({type:"danger",title:"Invalid Category Name",message:y,timeout:5e3}),!1;const e={name:g};return l.updateCategory(a,e),!1}}}})},l.validateCategoryName=function(a){if(!a||a.trim()==="")return"Category name cannot be empty.";if(typeof a!="string")return"Category name must be text.";if(a.length>50)return"Category name cannot be longer than 50 characters.";if(a.includes("/")||a.includes(":"))return'Category name cannot contain "/" or ":" characters.';const s=[];return $(".edit-category-btn").each(function(){const c=$(this).data("name");c&&c.toLowerCase()===a.toLowerCase()&&s.push(c)}),s.length>0?"A category with this name already exists.":null},l.updateCategory=function(a,s){v.put(`/categories/${a}`,s).then(function(){w.alert({type:"success",title:"Success",message:"Category updated successfully!",timeout:3e3}),$(".bootbox").modal("hide");const c=$(`.edit-category-btn[data-cid="${a}"]`);c.data("name",s.name);const h=c.closest('[component="categories/category"]'),g=h.find(".title");if(g.length){const e=g.find("a");e.length?e.text(s.name):g.text(s.name)}const y=h.find('meta[itemprop="name"]');y.length&&y.attr("content",s.name)}).catch(function(c){w.alert({type:"danger",title:"Error",message:c.message||"Failed to update category",timeout:5e3})})},l}.apply(C,E),p!==void 0&&(P.exports=p)}}]);
