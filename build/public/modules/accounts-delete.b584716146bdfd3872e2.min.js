"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,5719,34271,49897,99127],{47283:(x,E,u)=>{var h,g;h=[u(49897),u(33530),u(29930)],g=function(w,D,m){const c={};c.account=function(i,f){d(i,"[[user:delete-this-account-confirm]]","/account","[[user:account-deleted]]",f)},c.content=function(i,f){d(i,"[[user:delete-account-content-confirm]]","/content","[[user:account-content-deleted]]",f)},c.purge=function(i,f){d(i,"[[user:delete-all-confirm]]","","[[user:account-deleted]]",f)};function d(i,f,P,k,y){D.confirm(f,function(A){A&&w.del(`/users/${encodeURIComponent(i)}${P}`,{}).then(()=>{if(m.success(k),typeof y=="function")return y()}).catch(m.error)})}return c}.apply(E,h),g!==void 0&&(x.exports=g)},49897:(x,E,u)=>{u.r(E),u.d(E,{del:()=>A,get:()=>i,head:()=>f,patch:()=>k,post:()=>P,put:()=>y});var h=u(91749),g=u.n(h),w=u(33530),D=u.n(w);const m=config.relative_path+"/api/v3";async function c(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:m+e.url,typeof t=="function"){d(e).then(r=>t(null,r),r=>{let a=r;r instanceof Error||(a=new Error(String(r)));const s=a.message||String(a);if(s&&!s.startsWith("[[error:")&&(s.toLowerCase()==="fetch failed"||s.toLowerCase()==="failed to fetch"||s.toLowerCase().includes("networkerror")||s.toLowerCase().includes("network")&&s.toLowerCase().includes("failed"))){const o=new Error("[[error:no-connection]]");o.originalError=a,a=o}t(a)});return}try{return await d(e)}catch(r){if(r.message==="A valid login session was not found. Please log in and try again."){const{url:a}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,w.confirm)("[[error:api.reauth-required]]",s=>{s&&ajaxify.go(a)})}throw r}}async function d(e){const{url:t}=e;delete e.url,e.headers||(e.headers={}),e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8");try{({options:e}=await(0,h.fire)("filter:api.options",{options:e}))}catch(n){console.error("[API] Error in filter:api.options hook:",n)}e.data&&(e.body=e.data,delete e.data);let r;try{r=await fetch(t,e)}catch(n){const l=n.message||n.toString()||String(n),T=n.name||"Error";if(T==="TypeError"&&(l.toLowerCase().includes("fetch")||l.toLowerCase().includes("network")||l.toLowerCase().includes("failed to fetch")||l.toLowerCase().includes("load failed"))||l.toLowerCase().includes("cors")||l.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:t,method:e.method||"GET",error:l,name:T});const L=new Error("[[error:no-connection]]");throw L.originalError=n,L}throw console.error("[API] Unexpected fetch error:",{url:t,method:e.method||"GET",error:l,name:T}),n}const{headers:a}=r;if(a.get("x-redirect"))return d({url:a.get("x-redirect"),...e});const s=a.get("content-type"),C=s&&s.startsWith("application/json");let o;if(e.method!=="HEAD")try{C?o=await r.json():o=await r.text()}catch(n){throw console.error("[API] Error parsing response:",{url:t,status:r.status,statusText:r.statusText,contentType:s,error:n.message}),new Error("[[error:invalid-json]]")}if(!r.ok){let n;throw o?C&&o.status&&o.status.message?n=o.status.message:typeof o=="string"?n=o:n=r.statusText||"Request failed":n=r.statusText||"Request failed",new Error(n)}return C&&o&&o.hasOwnProperty("status")&&o.hasOwnProperty("response")?o.response:o}function i(e,t,r){return c({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},r)}function f(e,t,r){return c({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"HEAD"},r)}function P(e,t,r){return c({url:e,method:"POST",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function k(e,t,r){return c({url:e,method:"PATCH",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function y(e,t,r){return c({url:e,method:"PUT",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}function A(e,t,r){return c({url:e,method:"DELETE",data:t,headers:{"x-csrf-token":config.csrf_token}},r)}}}]);
