"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,15794,20644,25432,34271,49897,99127],{29869:M=>{M.exports=function(b,d,p){d.setGlobal("true",!0),d.setGlobal("false",!1);const w=24*60*60*1e3,g={displayMenuItem:y,buildMetaTag:h,buildLinkTag:v,stringify:S,escape:R,stripTags:D,buildCategoryIcon:N,buildCategoryLabel:U,generateCategoryBackground:A,generateChildrenCategories:n,generateTopicClass:o,membershipBtn:t,spawnPrivilegeStates:a,localeToHTML:i,renderTopicImage:l,renderDigestAvatar:c,userAgentIcons:u,buildAvatar:x,increment:W,generateWroteReplied:_,generateRepliedTo:B,generateWrote:H,encodeURIComponent:K,isoTimeToLocaleString:G,shouldHideReplyContainer:j,humanReadableNumber:z,formattedNumber:F,txEscape:J,generatePlaceholderWave:Y,register:Q,__escape:P};function P(e){return e}function y(e,r){const s=e.navigation[r];return!(!s||s.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||s.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||s.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function h(e){const r=e.name?'name="'+e.name+'" ':"",s=e.property?'property="'+e.property+'" ':"",m=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+r+s+m+`/>
	`}function v(e){const r=["link","rel","as","type","href","sizes","title","crossorigin"],[s,m,k,f,C,L,T,I]=r.map(E=>e[E]?`${E}="${e[E]}" `:"");return"<link "+s+m+k+f+L+T+C+I+`/>
	`}function S(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function R(e){return b.escapeHTML(e)}function D(e){return b.stripHTMLTags(e)}function N(e,r,s){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${s}" style="${A(e)} width:${r}; height: ${r}; font-size: ${parseInt(r,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function U(e,r="a",s=""){if(!e)return"";const m=r==="a"?`href="${p}/category/${e.slug}"`:"";return`<${r} ${m} class="badge px-1 text-truncate text-decoration-none ${s}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${r}>`}function A(e){if(!e)return"";const r=[];return e.bgColor&&(r.push("background-color: "+e.bgColor),r.push(`border-color: ${e.bgColor}!important`)),e.color&&r.push("color: "+e.color),e.backgroundImage&&(r.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&r.push("background-size: "+e.imageClass)),r.join("; ")+";"}function n(e){let r="";return!e||!e.children||!e.children.length||(e.children.forEach(function(s){if(s&&!s.isSection){const m=s.link?s.link:p+"/category/"+s.slug;r+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+A(s)+'"><i class="fa fa-fw '+s.icon+'"></i></div><a href="'+m+'"><small>'+s.name+"</small></a></span>"}}),r=r&&'<span class="category-children">'+r+"</span>"),r}function o(e){return["locked","pinned","deleted","unread","scheduled"].filter(s=>!!e[s]).join(" ")}function t(e,r=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${r}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${r}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${r}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function a(e,r,s,m){const k=[];for(const[f,C]of Object.entries(s))k.push({name:f,state:C,type:m[f]});return k.map(function(f){const C=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],L=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],T=["groups:moderate"];let I=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];e===-1&&(I=I.slice(3));const E=r==="guests"&&(C.includes(f.name)||f.name.startsWith("groups:admin:"))||r==="spiders"&&!L.includes(f.name)||r==="fediverse"&&!I.includes(f.name)||r==="Global Moderators"&&T.includes(f.name);return`
				<td data-privilege="${f.name}" data-value="${f.state}" data-type="${f.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${E?' d-none"':""}" autocomplete="off" type="checkbox"${f.state?" checked":""}${E?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function i(e,r){return e=e||r||"en-GB",e.replace("_","-")}function l(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.displayname+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.displayname+'" />'}function c(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function u(e){let r="";switch(e.platform){case"Linux":r+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":r+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":r+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":r+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":r+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":r+='<i class="fa fa-fw fa-mobile"></i>';break;default:r+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":r+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":r+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":r+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":r+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":r+='<i class="fa fa-fw fa-edge"></i>';break;default:r+='<i class="fa fa-fw fa-question-circle"></i>';break}return r}function x(e,r,s,m,k){e||(e=this),m=m||"";const f=new Map([["title",e.displayname],["data-uid",e.uid],["class",`avatar ${m}${s?" avatar-rounded":""}`]]),C=[`--avatar-size: ${r};`],L=I=>Array.from(I).reduce((E,[V,X])=>(E+=` ${V}="${X}"`,E),"");let T="";return e.picture&&(T+=`<img${L(f)} alt="${e.displayname}" loading="lazy" component="${k||"avatar/picture"}" src="${e.picture}" style="${C.join(" ")}" onError="this.remove()" itemprop="image" />`),T+=`<span${L(f)} component="${k||"avatar/icon"}" style="${C.join(" ")} background-color: ${e["icon:bgColor"]}">${e["icon:text"]}</span>`,T}function W(e,r){return String(e+parseInt(r,10))}function _(e,r){return e.toPid?B(e,r):H(e,r)}function B(e,r){const s=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-r*w?"on":"ago"}, ${e.toPid}, ${p}/post/${encodeURIComponent(e.toPid)}, ${s}, ${p}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function H(e,r){return`[[topic:wrote-${e.timestamp<Date.now()-r*w?"on":"ago"}, ${p}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function K(e){return encodeURIComponent(e)}function G(e,r="en-GB"){return new Date(e).toLocaleString([r],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function j(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function z(e,r=1){return b.makeNumberHumanReadable(e,r)}function F(e){return b.addCommas(e)}function J(e){return String(e).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function Y(e){return e.map(s=>s==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${s}"></div>
			</li>`).join("")}function Q(){Object.keys(g).forEach(function(e){d.registerHelper(e,g[e])})}return g}},30076:(M,b,d)=>{var p,w;const g=d(29869);p=[d(77918),d(81335)],w=function(P,y){return g(P,y,config.relative_path)}.apply(b,p),w!==void 0&&(M.exports=w)},49897:(M,b,d)=>{d.r(b),d.d(b,{del:()=>A,get:()=>S,head:()=>R,patch:()=>N,post:()=>D,put:()=>U});var p=d(91749),w=d.n(p),g=d(33530),P=d.n(g);const y=config.relative_path+"/api/v3";async function h(n,o){if(n.url=n.url.startsWith("/api")?config.relative_path+n.url:y+n.url,typeof o=="function"){v(n).then(t=>o(null,t),t=>{let a=t;t instanceof Error||(a=new Error(String(t)));const i=a.message||String(a);if(i&&!i.startsWith("[[error:")&&(i.toLowerCase()==="fetch failed"||i.toLowerCase()==="failed to fetch"||i.toLowerCase().includes("networkerror")||i.toLowerCase().includes("network")&&i.toLowerCase().includes("failed"))){const c=new Error("[[error:no-connection]]");c.originalError=a,a=c}o(a)});return}try{return await v(n)}catch(t){if(t.message==="A valid login session was not found. Please log in and try again."){const{url:a}=await(0,p.fire)("filter:admin.reauth",{url:"login"});return(0,g.confirm)("[[error:api.reauth-required]]",i=>{i&&ajaxify.go(a)})}throw t}}async function v(n){const{url:o}=n;delete n.url,n.headers||(n.headers={}),n.data&&!(n.data instanceof FormData)&&(n.data=JSON.stringify(n.data||{}),n.headers["content-type"]="application/json; charset=utf-8");try{({options:n}=await(0,p.fire)("filter:api.options",{options:n}))}catch(u){console.error("[API] Error in filter:api.options hook:",u)}n.data&&(n.body=n.data,delete n.data);let t;try{t=await fetch(o,n)}catch(u){const x=u.message||u.toString()||String(u),W=u.name||"Error";if(W==="TypeError"&&(x.toLowerCase().includes("fetch")||x.toLowerCase().includes("network")||x.toLowerCase().includes("failed to fetch")||x.toLowerCase().includes("load failed"))||x.toLowerCase().includes("cors")||x.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:o,method:n.method||"GET",error:x,name:W});const B=new Error("[[error:no-connection]]");throw B.originalError=u,B}throw console.error("[API] Unexpected fetch error:",{url:o,method:n.method||"GET",error:x,name:W}),u}const{headers:a}=t;if(a.get("x-redirect"))return v({url:a.get("x-redirect"),...n});const i=a.get("content-type"),l=i&&i.startsWith("application/json");let c;if(n.method!=="HEAD")try{l?c=await t.json():c=await t.text()}catch(u){throw console.error("[API] Error parsing response:",{url:o,status:t.status,statusText:t.statusText,contentType:i,error:u.message}),new Error("[[error:invalid-json]]")}if(!t.ok){let u;throw c?l&&c.status&&c.status.message?u=c.status.message:typeof c=="string"?u=c:u=t.statusText||"Request failed":u=t.statusText||"Request failed",new Error(u)}return l&&c&&c.hasOwnProperty("status")&&c.hasOwnProperty("response")?c.response:c}function S(n,o,t){return h({url:n+(o&&Object.keys(o).length?"?"+$.param(o):"")},t)}function R(n,o,t){return h({url:n+(o&&Object.keys(o).length?"?"+$.param(o):""),method:"HEAD"},t)}function D(n,o,t){return h({url:n,method:"POST",data:o,headers:{"x-csrf-token":config.csrf_token}},t)}function N(n,o,t){return h({url:n,method:"PATCH",data:o,headers:{"x-csrf-token":config.csrf_token}},t)}function U(n,o,t){return h({url:n,method:"PUT",data:o,headers:{"x-csrf-token":config.csrf_token}},t)}function A(n,o,t){return h({url:n,method:"DELETE",data:o,headers:{"x-csrf-token":config.csrf_token}},t)}},89664:(M,b,d)=>{var p,w;p=[d(49897),d(33530),d(29930),d(30076)],w=function(g,P,y,h){const v={};let S;v.init=function(t){S=t||"groups/details",R(),N(),U()},v.refresh=async function(){const{group:t}=await g.get(`/api/groups/${ajaxify.data.group.slug}`),a=await o(t.members);$('[component="groups/members"] tbody').html(a),$('[component="group/member/count"]').text(h.humanReadableNumber(t.memberCount)),$('[component="group/pending/count"]').text(h.humanReadableNumber(t.pending.length)),$('[component="group/invited/count"]').text(h.humanReadableNumber(t.invited.length)),ajaxify.data.group.members=t.members,ajaxify.data.group.memberCount=t.memberCount,ajaxify.data.group.invited=t.invited,ajaxify.data.group.pending=t.pending};function R(){$('[component="groups/members/add"]').on("click",function(){app.parseAndTranslate("admin/partials/groups/add-members",{},function(t){const a=[],i=P.dialog({title:"[[groups:details.add-member]]",message:t,buttons:{OK:{label:"[[groups:details.add-member]]",callback:function(){const l=[];i.find("[data-uid][data-selected]").each(function(c,u){l.push(a[$(u).attr("data-uid")])}),D(l).then(()=>{i.modal("hide")})}}}});i.on("click","[data-username]",function(){$(this).attr("data-selected")==="1"?$(this).removeAttr("data-selected"):$(this).attr("data-selected",1),$(this).find("i").toggleClass("invisible")}),i.find("input").on("keyup",function(){g.get("/api/users",{query:$(this).val(),paginate:!1},function(l,c){if(l)return y.error(l);c.users.forEach(function(u){a[u.uid]=u}),app.parseAndTranslate("admin/partials/groups/add-members","users",{users:c.users},function(u){i.find("#search-result").html(u)})})})})})}async function D(t){const a=t.map(l=>l.uid);ajaxify.data.group.name==="administrators"?await socket.emit("admin.user.makeAdmins",a).catch(y.error):await Promise.all(a.map(l=>g.put("/groups/"+ajaxify.data.group.slug+"/membership/"+l))).catch(y.error),t=t.filter(l=>!$('[component="groups/members"] [data-uid="'+l.uid+'"]').length);const i=await o(t);$('[component="groups/members"] tbody').prepend(i)}function N(){const t=$('[component="groups/members/search"]');t.on("keyup",utils.debounce(async function(){const a=t.val(),i=await g.get(`/groups/${ajaxify.data.group.slug}/members`,{query:a}),l=await o(i.users);$('[component="groups/members"] tbody').html(l),$('[component="groups/members"]').attr("data-nextstart",20)},250))}function U(){$('[component="groups/members"]').on("scroll",utils.debounce(function(){const t=$(this),a=(t[0].scrollHeight-t.innerHeight())*.9;t.scrollTop()>a&&!$('[component="groups/members/search"]').val()&&A()},250))}async function A(){const t=$('[component="groups/members"]');if(t.attr("loading"))return;t.attr("loading",1);const a=await g.get(`/groups/${ajaxify.data.group.slug}/members`,{after:t.attr("data-nextstart")}).catch(y.error);a&&a.users.length?(await n(a.users),t.removeAttr("loading"),t.attr("data-nextstart",a.nextStart)):t.removeAttr("loading")}async function n(t){t=t.filter(function(i){return!$('[component="groups/members"] [data-uid="'+i.uid+'"]').length});const a=await o(t);$('[component="groups/members"] tbody').append(a)}async function o(t){return await app.parseAndTranslate(S,"group.members",{group:{members:t,isOwner:ajaxify.data.group.isOwner}})}return v}.apply(b,p),w!==void 0&&(M.exports=w)}}]);
