"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,49897,93806,99127],{49897:(x,y,c)=>{c.r(y),c.d(y,{del:()=>d,get:()=>n,head:()=>r,patch:()=>f,post:()=>o,put:()=>u});var m=c(91749),E=c.n(m),p=c(33530),D=c.n(p);const g=config.relative_path+"/api/v3";async function l(t,a){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:g+t.url,typeof a=="function"){s(t).then(e=>a(null,e),e=>a(e));return}try{return await s(t)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:h}=await(0,m.fire)("filter:admin.reauth",{url:"login"});return(0,p.confirm)("[[error:api.reauth-required]]",C=>{C&&ajaxify.go(h)})}throw e}}async function s(t){const{url:a}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,m.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const e=await fetch(a,t),{headers:h}=e;if(h.get("x-redirect"))return s({url:h.get("x-redirect"),...t});const C=h.get("content-type"),b=C&&C.startsWith("application/json");let i;if(t.method!=="HEAD"&&(b?i=await e.json():i=await e.text()),!e.ok)throw i?new Error(b?i.status.message:i):new Error(e.statusText);return b&&i&&i.hasOwnProperty("status")&&i.hasOwnProperty("response")?i.response:i}function n(t,a,e){return l({url:t+(a&&Object.keys(a).length?"?"+$.param(a):"")},e)}function r(t,a,e){return l({url:t+(a&&Object.keys(a).length?"?"+$.param(a):""),method:"HEAD"},e)}function o(t,a,e){return l({url:t,method:"POST",data:a,headers:{"x-csrf-token":config.csrf_token}},e)}function f(t,a,e){return l({url:t,method:"PATCH",data:a,headers:{"x-csrf-token":config.csrf_token}},e)}function u(t,a,e){return l({url:t,method:"PUT",data:a,headers:{"x-csrf-token":config.csrf_token}},e)}function d(t,a,e){return l({url:t,method:"DELETE",data:a,headers:{"x-csrf-token":config.csrf_token}},e)}},78048:(x,y,c)=>{var m,E;m=[c(33530),c(49897),c(29930),c(17459)],E=function(p,D,g,l){const s={};return s.init=function(){$(document).on("click",".edit-category-btn",function(n){n.preventDefault(),n.stopPropagation();const r=$(this),o=r.data("cid"),f=r.data("name")||"";s.showEditModal(o,f)})},s.showEditModal=function(n,r){p.dialog({title:"Edit Category",message:`
				<form id="edit-category-form">
					<div class="mb-3">
						<label for="category-name" class="form-label">Category Name</label>
						<input type="text" class="form-control" id="category-name" name="name" value="${l.escape(r)}" required>
					</div>
				</form>
			`,buttons:{cancel:{label:"Cancel",className:"btn-secondary"},save:{label:"Save Changes",className:"btn-primary",callback:function(){const o=document.getElementById("edit-category-form"),u=new FormData(o).get("name"),d=s.validateCategoryName(u);if(d)return g.alert({type:"danger",title:"Invalid Category Name",message:d,timeout:5e3}),!1;const t={name:u};return s.updateCategory(n,t),!1}}}})},s.validateCategoryName=function(n){if(!n||n.trim()==="")return"Category name cannot be empty.";if(typeof n!="string")return"Category name must be text.";if(n.length>50)return"Category name cannot be longer than 50 characters.";if(n.includes("/")||n.includes(":"))return'Category name cannot contain "/" or ":" characters.';const r=[];return $(".edit-category-btn").each(function(){const o=$(this).data("name");o&&o.toLowerCase()===n.toLowerCase()&&r.push(o)}),r.length>0?"A category with this name already exists.":null},s.updateCategory=function(n,r){D.put(`/categories/${n}`,r).then(function(){g.alert({type:"success",title:"Success",message:"Category updated successfully!",timeout:3e3}),$(".bootbox").modal("hide");const o=$(`.edit-category-btn[data-cid="${n}"]`);o.data("name",r.name);const f=o.closest('[component="categories/category"]'),u=f.find(".title");if(u.length){const t=u.find("a");t.length?t.text(r.name):u.text(r.name)}const d=f.find('meta[itemprop="name"]');d.length&&d.attr("content",r.name)}).catch(function(o){g.alert({type:"danger",title:"Error",message:o.message||"Failed to update category",timeout:5e3})})},s}.apply(y,m),E!==void 0&&(x.exports=E)}}]);
