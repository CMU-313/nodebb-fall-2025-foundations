(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,12922,15794,25432,26174,34271,36159,46379,49897,52185,62441,74566,88189,92332,98463,99127],{12236:(P,y,l)=>{"use strict";var v,b;v=[l(49897),l(29930)],b=function(h,A){const c={};c.init=function(t,r){const o=t.find(".draft-icon"),n=t.attr("data-uuid");function i(){$(`[component="composer"][data-uuid="${n}"]`).length&&(r.save_id||(r.save_id=utils.generateSaveId(app.user.uid)),c.addToDraftList("available",r.save_id),c.addToDraftList("open",r.save_id),u(t,o,r))}t.on("keyup","textarea, input.handle, input.title",utils.debounce(i,1e3)),t.on("click",'input[type="checkbox"]',utils.debounce(i,1e3)),t.on("click",'[component="category/list"] [data-cid]',utils.debounce(i,1e3)),t.on("itemAdded",".tags",utils.debounce(i,1e3)),t.on("thumb.uploaded",i),o.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const a=c.getList("open");a.length&&a.forEach(g=>c.removeFromDraftList("open",g))}),c.migrateGuest(),c.migrateThumbs(...arguments)};function I(t){return parseInt(t,10)>0?localStorage:sessionStorage}c.get=function(t){if(!t)return null;const r=t.split(":")[1],o=I(r);try{const n=o.getItem(t),i=JSON.parse(n)||null;if(!i)throw new Error(`can't parse draft json for ${t}`);return i.save_id=t,i.timestamp&&(i.timestampISO=utils.toISOString(i.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:t,draft:i,storage:o}),i}catch{return console.warn(`[composer/drafts] Could not get draft ${t}, removing`),c.removeFromDraftList("available"),c.removeFromDraftList("open"),null}};function u(t,r,o){if(f(app.user.uid?"localStorage":"sessionStorage")&&o&&o.save_id&&t.length){const n=t.find("input.title"),i=n&&n.length&&n.val(),a=t.find("textarea").val(),g=I(app.user.uid);if(a.length||i&&i.length){const m={save_id:o.save_id,action:o.action,text:a,uuid:t.attr("data-uuid"),timestamp:Date.now()};if(o.action==="topics.post"){const D=t.find("input.tags").val();m.tags=D,m.title=i,m.cid=o.cid}else o.action==="posts.reply"?(m.title=o.title,m.tid=o.tid,m.toPid=o.toPid):o.action==="posts.edit"&&(m.pid=o.pid,m.title=i||o.title);app.user.uid||(m.handle=t.find("input.handle").val()),g.setItem(o.save_id,JSON.stringify(m)),$(window).trigger("action:composer.drafts.save",{storage:g,postData:o,postContainer:t}),r.toggleClass("active",!0)}else c.removeDraft(o.save_id)}}c.removeDraft=function(t){if(!t)return;c.removeFromDraftList("available",t),c.removeFromDraftList("open",t);const r=t.split(":")[1],o=I(r);o.removeItem(t),$(window).trigger("action:composer.drafts.remove",{storage:o,save_id:t})},c.getList=function(t){try{const r=localStorage.getItem(`drafts:${t}`);return JSON.parse(r)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},c.addToDraftList=function(t,r){if(!f(app.user.uid?"localStorage":"sessionStorage")||!r)return;const o=c.getList(t);o.includes(r)||(o.push(r),localStorage.setItem("drafts:"+t,JSON.stringify(o)))},c.removeFromDraftList=function(t,r){if(!f(app.user.uid?"localStorage":"sessionStorage")||!r)return;const o=c.getList(t);o.includes(r)&&(o.splice(o.indexOf(r),1),localStorage.setItem("drafts:"+t,JSON.stringify(o)))},c.migrateGuest=function(){if(f("localStorage")&&app.user.uid){const t=/^composer:\d+:\d$/,r=Object.keys(sessionStorage).filter(function(i){return t.test(i)}),o=new Set([]),n=r.map(function(i){const a=i.split(":");return a[1]=app.user.uid,o.add(a.join(":")),a.join(":")});return r.forEach(function(i,a){localStorage.setItem(n[a],sessionStorage.getItem(i)),sessionStorage.removeItem(i)}),o.forEach(function(i){c.addToDraftList("available",i)}),o}},c.migrateThumbs=function(t,r){if(!app.uid)return;const o=t.attr("data-uuid"),n=c.get(r.save_id);n&&n.uuid&&h.put(`/topics/${n.uuid}/thumbs`,{tid:o}).then(()=>{Promise.all([l.e(20056),l.e(23662),l.e(65285),l.e(40559),l.e(449),l.e(5785),l.e(36159)]).then(function(){var i=[l(71431)];(function(a){a.updateThumbCount(o,t)}).apply(null,i)}).catch(l.oe)})},c.listAvailable=function(){return c.getList("available").map(c.get).filter(Boolean)},c.getAvailableCount=function(){return c.listAvailable().length},c.open=function(t){if(!t)return;const r=c.get(t);d(t,r)},c.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const t=c.getList("available"),r=c.getList("open");t.length&&t.forEach(function(o){if(!o||r.includes(o))return;const n=c.get(o);if(!n||!n.text&&!n.title){c.removeFromDraftList("available",o),c.removeFromDraftList("open",o);return}d(o,n)})};function d(t,r){const n=t.split(":")[1];parseInt(app.user.uid,10)===parseInt(n,10)&&Promise.all([l.e(20056),l.e(23662),l.e(65285),l.e(40559),l.e(449),l.e(5785),l.e(36159)]).then(function(){var i=[l(71431)];(function(a){r.action==="topics.post"?a.newTopic({save_id:r.save_id,cid:r.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(r.handle),title:utils.escapeHTML(r.title),body:r.text,tags:String(r.tags||"").split(",")}):r.action==="posts.reply"?h.get("/topics/"+r.tid,{},function(g,m){if(g)return A.error(g);a.newReply({save_id:r.save_id,tid:r.tid,toPid:r.toPid,title:m.title,body:r.text})}):r.action==="posts.edit"&&a.editPost({save_id:r.save_id,pid:r.pid,title:r.title?utils.escapeHTML(r.title):void 0,body:r.text})}).apply(null,i)}).catch(l.oe)}function f(t){var r;try{r=window[t];var o="__storage_test__";return r.setItem(o,o),r.removeItem(o),!0}catch(n){return n instanceof DOMException&&(n.code===22||n.code===1014||n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&r&&r.length!==0}}return c}.apply(y,v),b!==void 0&&(P.exports=b)},13230:(P,y,l)=>{"use strict";var v,b,h;(function(A){b=[l(53050)],v=A,h=typeof v=="function"?v.apply(y,b):v,h!==void 0&&(P.exports=h)})(function(A){const c=A("[^\\p{L}\\s\\d\\-_@.]","g"),x=/[^\w\s\d\-_@.]/g,I=/^\s+|\s+$/g,u=/\s+/g,d=/-+/g,f=/-$/g,t=/^-/g,r=/^[\w\d\s.,\-@]+$/;return function(n,i){return n?(n=String(n).replace(I,""),r.test(n)?n=n.replace(x,"-"):n=A.replace(n,c,"-"),n=i?n:n.toLocaleLowerCase(),n=n.replace(u,"-"),n=n.replace(d,"-"),n=n.replace(f,""),n=n.replace(t,""),n):""}})},24187:(P,y,l)=>{"use strict";var v,b;v=[l(64061)],b=function(){const h={};h.show=function(u,d){const f=u.hasOwnProperty("fileSize")&&u.fileSize!==void 0?parseInt(u.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:u.hasOwnProperty("showHelp")&&u.showHelp!==void 0?u.showHelp:!0,fileSize:f,title:u.title||"[[global:upload-file]]",description:u.description||"",button:u.button||"[[global:upload]]",accept:u.accept?u.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const r=t.find("#uploadForm");r.attr("action",u.route),r.find("#params").val(JSON.stringify(u.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),r.submit()}),r.submit(function(){return A(t,f,d),!1})})},h.hideAlerts=function(u){$(u).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function A(u,d,f){c(u,"status","[[uploads:uploading-file]]"),u.find("#upload-progress-bar").css("width","0%"),u.find("#upload-progress-box").show().removeClass("hide");const t=u.find("#fileInput");if(!t.val())return c(u,"error","[[uploads:select-file-to-upload]]");if(!I(t[0],d))return c(u,"error","[[error:file-too-big, "+d+"]]");h.ajaxSubmit(u,f)}function c(u,d,f){h.hideAlerts(u),d==="error"&&u.find("#fileUploadSubmitBtn").removeClass("disabled"),f=f.replace(/&amp;#44/g,"&#44"),u.find("#alert-"+d).translateText(f).removeClass("hide")}h.ajaxSubmit=function(u,d){u.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=x(t),c(u,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,r,o,n){u.find("#upload-progress-bar").css("width",n+"%")},success:function(t){let r=x(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(r=t.response.images),d(r[0].url),c(u,"success","[[uploads:upload-success]]"),setTimeout(function(){h.hideAlerts(u),u.modal("hide")},750)}})};function x(u){if(typeof u=="string")try{return JSON.parse(u)}catch(d){return console.error(d),{error:"[[error:parse-error]]"}}return u}function I(u,d){return window.FileReader&&d?u.files[0].size<=d*1e3:!0}return h}.apply(y,v),b!==void 0&&(P.exports=b)},29869:P=>{"use strict";P.exports=function(y,l,v){l.setGlobal("true",!0),l.setGlobal("false",!1);const b=24*60*60*1e3,h={displayMenuItem:c,buildMetaTag:x,buildLinkTag:I,stringify:u,escape:d,stripTags:f,buildCategoryIcon:t,buildCategoryLabel:r,generateCategoryBackground:o,generateChildrenCategories:n,generateTopicClass:i,membershipBtn:a,spawnPrivilegeStates:g,localeToHTML:m,renderTopicImage:D,renderDigestAvatar:E,userAgentIcons:w,buildAvatar:L,increment:W,generateWroteReplied:M,generateRepliedTo:k,generateWrote:O,encodeURIComponent:K,isoTimeToLocaleString:H,shouldHideReplyContainer:J,humanReadableNumber:z,formattedNumber:Y,txEscape:G,generatePlaceholderWave:j,register:Q,__escape:A};function A(e){return e}function c(e,s){const p=e.navigation[s];return!(!p||p.route.match("/users")&&e.user&&!e.user.privileges["view:users"]||p.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"]||p.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])}function x(e){const s=e.name?'name="'+e.name+'" ':"",p=e.property?'property="'+e.property+'" ':"",C=e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"";return"<meta "+s+p+C+`/>
	`}function I(e){const s=["link","rel","as","type","href","sizes","title","crossorigin"],[p,C,T,S,N,U,B,F]=s.map(R=>e[R]?`${R}="${e[R]}" `:"");return"<link "+p+C+T+S+U+B+N+F+`/>
	`}function u(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function d(e){return y.escapeHTML(e)}function f(e){return y.stripHTMLTags(e)}function t(e,s,p){return e?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${p}" style="${o(e)} width:${s}; height: ${s}; font-size: ${parseInt(s,10)/2}px;">${e.icon?`<i class="fa fa-fw ${e.icon}"></i>`:""}</span>`:""}function r(e,s="a",p=""){if(!e)return"";const C=s==="a"?`href="${v}/category/${e.slug}"`:"";return`<${s} ${C} class="badge px-1 text-truncate text-decoration-none ${p}" style="color: ${e.color};background-color: ${e.bgColor};border-color: ${e.bgColor}!important; max-width: 70vw;">
			${e.icon&&e.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${e.icon}"></i>`:""}
			${e.name}
		</${s}>`}function o(e){if(!e)return"";const s=[];return e.bgColor&&(s.push("background-color: "+e.bgColor),s.push(`border-color: ${e.bgColor}!important`)),e.color&&s.push("color: "+e.color),e.backgroundImage&&(s.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&s.push("background-size: "+e.imageClass)),s.join("; ")+";"}function n(e){let s="";return!e||!e.children||!e.children.length||(e.children.forEach(function(p){if(p&&!p.isSection){const C=p.link?p.link:v+"/category/"+p.slug;s+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+o(p)+'"><i class="fa fa-fw '+p.icon+'"></i></div><a href="'+C+'"><small>'+p.name+"</small></a></span>"}}),s=s&&'<span class="category-children">'+s+"</span>"),s}function i(e){return["locked","pinned","deleted","unread","scheduled"].filter(p=>!!e[p]).join(" ")}function a(e,s=""){return e.isMember&&e.name!=="administrators"?`<button class="btn btn-danger ${s}" data-action="leave" data-group="${e.displayName}" ${e.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:e.isPending&&e.name!=="administrators"?`<button class="btn btn-warning disabled ${s}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:e.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${e.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${e.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!e.disableJoinRequests&&e.name!=="administrators"?`<button class="btn btn-success ${s}" data-action="join" data-group="${e.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function g(e,s,p,C){const T=[];for(const[S,N]of Object.entries(p))T.push({name:S,state:N,type:C[S]});return T.map(function(S){const N=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],U=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],B=["groups:moderate"];let F=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];e===-1&&(F=F.slice(3));const R=s==="guests"&&(N.includes(S.name)||S.name.startsWith("groups:admin:"))||s==="spiders"&&!U.includes(S.name)||s==="fediverse"&&!F.includes(S.name)||s==="Global Moderators"&&B.includes(S.name);return`
				<td data-privilege="${S.name}" data-value="${S.state}" data-type="${S.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${R?' d-none"':""}" autocomplete="off" type="checkbox"${S.state?" checked":""}${R?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function m(e,s){return e=e||s||"en-GB",e.replace("_","-")}function D(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.displayname+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.displayname+'" />'}function E(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"}function w(e){let s="";switch(e.platform){case"Linux":s+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":s+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":s+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":s+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":s+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":s+='<i class="fa fa-fw fa-mobile"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(e.browser){case"Chrome":s+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":s+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":s+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":s+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":s+='<i class="fa fa-fw fa-edge"></i>';break;default:s+='<i class="fa fa-fw fa-question-circle"></i>';break}return s}function L(e,s,p,C,T){e||(e=this),C=C||"";const S=new Map([["title",e.displayname],["data-uid",e.uid],["class",`avatar ${C}${p?" avatar-rounded":""}`]]),N=[`--avatar-size: ${s};`],U=F=>Array.from(F).reduce((R,[V,Z])=>(R+=` ${V}="${Z}"`,R),"");let B="";return e.picture&&(B+=`<img${U(S)} alt="${e.displayname}" loading="lazy" component="${T||"avatar/picture"}" src="${e.picture}" style="${N.join(" ")}" onError="this.remove()" itemprop="image" />`),B+=`<span${U(S)} component="${T||"avatar/icon"}" style="${N.join(" ")} background-color: ${e["icon:bgColor"]}">${e["icon:text"]}</span>`,B}function W(e,s){return String(e+parseInt(s,10))}function M(e,s){return e.toPid?k(e,s):O(e,s)}function k(e,s){const p=e.parent&&e.parent.displayname?e.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${e.timestamp<Date.now()-s*b?"on":"ago"}, ${e.toPid}, ${v}/post/${encodeURIComponent(e.toPid)}, ${p}, ${v}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function O(e,s){return`[[topic:wrote-${e.timestamp<Date.now()-s*b?"on":"ago"}, ${v}/post/${encodeURIComponent(e.pid)}, ${e.timestampISO}]]`}function K(e){return encodeURIComponent(e)}function H(e,s="en-GB"){return new Date(e).toLocaleString([s],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function J(e){return!!(e.replies.count<=0||e.replies.hasSingleImmediateReply)}function z(e,s=1){return y.makeNumberHumanReadable(e,s)}function Y(e){return y.addCommas(e)}function G(e){return String(e).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function j(e){return e.map(p=>p==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${p}"></div>
			</li>`).join("")}function Q(){Object.keys(h).forEach(function(e){l.registerHelper(e,h[e])})}return h}},30076:(P,y,l)=>{"use strict";var v,b;const h=l(29869);v=[l(77918),l(81335)],b=function(A,c){return h(A,c,config.relative_path)}.apply(y,v),b!==void 0&&(P.exports=b)},36159:(P,y,l)=>{"use strict";var v,b;v=[l(49897),l(33530),l(29930),l(24187),l(81335),l(17459),l(65285)],b=function(h,A,c,x,I,u){const d={};return d.get=f=>h.get(`/topics/${f}/thumbs`,{thumbsOnly:1}),d.getByPid=f=>h.get(`/posts/${encodeURIComponent(f)}`,{}).then(t=>d.get(t.tid)),d.delete=(f,t)=>h.del(`/topics/${f}/thumbs`,{path:t}),d.deleteAll=f=>{d.get(f).then(t=>{Promise.all(t.map(r=>d.delete(f,r.url)))})},d.upload=f=>new Promise(t=>{x.show({title:"[[topic:composer.thumb-title]]",method:"put",route:config.relative_path+`/api/v3/topics/${f}/thumbs`},function(r){t(r)})}),d.modal={},d.modal.open=function(f){const{id:t,pid:r}=f;let{modal:o}=f,n;return new Promise(i=>{Promise.all([d.get(t),r?d.getByPid(r):[]]).then(a=>new Promise(g=>{const m=a.reduce((D,E)=>D.concat(E));n=m.length,g(m)})).then(a=>I.render("modals/topic-thumbs",{thumbs:a})).then(a=>{o?u.translate(a,function(g){o.find(".bootbox-body").html(g),d.modal.handleSort({modal:o,numThumbs:n})}):(o=A.dialog({title:"[[modules:thumbs.modal.title]]",message:a,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(d.upload(t).then(()=>{d.modal.open({...f,modal:o}),Promise.all([l.e(20056),l.e(40559),l.e(449),l.e(5785),l.e(52185)]).then(function(){var g=[l(71431)];(m=>{m.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`)),i()}).apply(null,g)}).catch(l.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),d.modal.handleDelete({...f,modal:o}),d.modal.handleSort({modal:o,numThumbs:n}))})})},d.modal.handleDelete=f=>{const t=f.modal.get(0),{id:r}=f;t.addEventListener("click",o=>{o.target.closest('button[data-action="remove"]')&&A.confirm("[[modules:thumbs.modal.confirm-remove]]",n=>{if(!n)return;const i=o.target.closest("[data-id]").getAttribute("data-id"),a=o.target.closest("[data-path]").getAttribute("data-path");h.del(`/topics/${i}/thumbs`,{path:a}).then(()=>{d.modal.open(f),Promise.all([l.e(20056),l.e(40559),l.e(449),l.e(5785),l.e(52185)]).then(function(){var g=[l(71431)];(m=>{m.updateThumbCount(r,$(`[component="composer"][data-uuid="${r}"]`))}).apply(null,g)}).catch(l.oe)}).catch(c.error)})})},d.modal.handleSort=({modal:f,numThumbs:t})=>{if(t>1){const r=f.find(".topic-thumbs-modal");r.sortable({items:"[data-id]"}),r.on("sortupdate",d.modal.handleSortChange)}},d.modal.handleSortChange=(f,t)=>{const r=t.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(r).forEach((o,n)=>{const i=o.getAttribute("data-id");let a=o.getAttribute("data-path");a=a.replace(new RegExp(`^${config.upload_url}`),""),h.put(`/topics/${i}/thumbs/order`,{path:a,order:n}).catch(c.error)})},d}.apply(y,v),b!==void 0&&(P.exports=b)},49897:(P,y,l)=>{"use strict";l.r(y),l.d(y,{del:()=>o,get:()=>u,head:()=>d,patch:()=>t,post:()=>f,put:()=>r});var v=l(91749),b=l.n(v),h=l(33530),A=l.n(h);const c=config.relative_path+"/api/v3";async function x(n,i){if(n.url=n.url.startsWith("/api")?config.relative_path+n.url:c+n.url,typeof i=="function"){I(n).then(a=>i(null,a),a=>{let g=a;a instanceof Error||(g=new Error(String(a)));const m=g.message||String(g);if(m&&!m.startsWith("[[error:")&&(m.toLowerCase()==="fetch failed"||m.toLowerCase()==="failed to fetch"||m.toLowerCase().includes("networkerror")||m.toLowerCase().includes("network")&&m.toLowerCase().includes("failed"))){const E=new Error("[[error:no-connection]]");E.originalError=g,g=E}i(g)});return}try{return await I(n)}catch(a){if(a.message==="A valid login session was not found. Please log in and try again."){const{url:g}=await(0,v.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",m=>{m&&ajaxify.go(g)})}throw a}}async function I(n){const{url:i}=n;delete n.url,n.headers||(n.headers={}),n.data&&!(n.data instanceof FormData)&&(n.data=JSON.stringify(n.data||{}),n.headers["content-type"]="application/json; charset=utf-8");try{({options:n}=await(0,v.fire)("filter:api.options",{options:n}))}catch(w){console.error("[API] Error in filter:api.options hook:",w)}n.data&&(n.body=n.data,delete n.data);let a;try{a=await fetch(i,n)}catch(w){const L=w.message||w.toString()||String(w),W=w.name||"Error";if(W==="TypeError"&&(L.toLowerCase().includes("fetch")||L.toLowerCase().includes("network")||L.toLowerCase().includes("failed to fetch")||L.toLowerCase().includes("load failed"))||L.toLowerCase().includes("cors")||L.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:i,method:n.method||"GET",error:L,name:W});const k=new Error("[[error:no-connection]]");throw k.originalError=w,k}throw console.error("[API] Unexpected fetch error:",{url:i,method:n.method||"GET",error:L,name:W}),w}const{headers:g}=a;if(g.get("x-redirect"))return I({url:g.get("x-redirect"),...n});const m=g.get("content-type"),D=m&&m.startsWith("application/json");let E;if(n.method!=="HEAD")try{D?E=await a.json():E=await a.text()}catch(w){throw console.error("[API] Error parsing response:",{url:i,status:a.status,statusText:a.statusText,contentType:m,error:w.message}),new Error("[[error:invalid-json]]")}if(!a.ok){let w;throw E?D&&E.status&&E.status.message?w=E.status.message:typeof E=="string"?w=E:w=a.statusText||"Request failed":w=a.statusText||"Request failed",new Error(w)}return D&&E&&E.hasOwnProperty("status")&&E.hasOwnProperty("response")?E.response:E}function u(n,i,a){return x({url:n+(i&&Object.keys(i).length?"?"+$.param(i):"")},a)}function d(n,i,a){return x({url:n+(i&&Object.keys(i).length?"?"+$.param(i):""),method:"HEAD"},a)}function f(n,i,a){return x({url:n,method:"POST",data:i,headers:{"x-csrf-token":config.csrf_token}},a)}function t(n,i,a){return x({url:n,method:"PATCH",data:i,headers:{"x-csrf-token":config.csrf_token}},a)}function r(n,i,a){return x({url:n,method:"PUT",data:i,headers:{"x-csrf-token":config.csrf_token}},a)}function o(n,i,a){return x({url:n,method:"DELETE",data:i,headers:{"x-csrf-token":config.csrf_token}},a)}},74566:(P,y,l)=>{P.exports=l(12236)}}]);
