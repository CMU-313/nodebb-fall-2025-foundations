"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,34271,45490,49897,99127],{37130:(P,E,i)=>{var h,w;h=[i(49897),i(33530),i(29930)],w=function(g,T,m){const a={};a.init=function(){$('button[data-action="new"]').on("click",function(){T.prompt("[[groups:new-group.group-name]]",function(l){l&&l.length&&g.post("/groups",{name:l}).then(f=>{ajaxify.go("groups/"+f.slug)}).catch(m.error)})});const d=utils.params();$("#search-sort").val(d.sort||"alpha"),$("#search-text").on("keyup",utils.debounce(a.search,200)),$("#search-button").on("click",a.search),$("#search-sort").on("change",function(){ajaxify.go("groups?sort="+$("#search-sort").val())})},a.search=function(){return g.get("/api/groups",{query:$("#search-text").val(),sort:$("#search-sort").val(),filterHidden:!0,showMembers:!0,hideEphemeralGroups:!0}).then(p).catch(m.error),!1};function p(d){app.parseAndTranslate("partials/paginator",{pagination:d.pagination}).then(function(f){$(".pagination-container").replaceWith(f)});const l=$("#groups-list");app.parseAndTranslate("partials/groups/list",{groups:d.groups}).then(function(f){l.empty().append(f)})}return a}.apply(E,h),w!==void 0&&(P.exports=w)},49897:(P,E,i)=>{i.r(E),i.d(E,{del:()=>L,get:()=>d,head:()=>l,patch:()=>A,post:()=>f,put:()=>C});var h=i(91749),w=i.n(h),g=i(33530),T=i.n(g);const m=config.relative_path+"/api/v3";async function a(r,t){if(r.url=r.url.startsWith("/api")?config.relative_path+r.url:m+r.url,typeof t=="function"){p(r).then(e=>t(null,e),e=>{let c=e;e instanceof Error||(c=new Error(String(e)));const s=c.message||String(c);if(s&&!s.startsWith("[[error:")&&(s.toLowerCase()==="fetch failed"||s.toLowerCase()==="failed to fetch"||s.toLowerCase().includes("networkerror")||s.toLowerCase().includes("network")&&s.toLowerCase().includes("failed"))){const o=new Error("[[error:no-connection]]");o.originalError=c,c=o}t(c)});return}try{return await p(r)}catch(e){if(e.message==="A valid login session was not found. Please log in and try again."){const{url:c}=await(0,h.fire)("filter:admin.reauth",{url:"login"});return(0,g.confirm)("[[error:api.reauth-required]]",s=>{s&&ajaxify.go(c)})}throw e}}async function p(r){const{url:t}=r;delete r.url,r.headers||(r.headers={}),r.data&&!(r.data instanceof FormData)&&(r.data=JSON.stringify(r.data||{}),r.headers["content-type"]="application/json; charset=utf-8");try{({options:r}=await(0,h.fire)("filter:api.options",{options:r}))}catch(n){console.error("[API] Error in filter:api.options hook:",n)}r.data&&(r.body=r.data,delete r.data);let e;try{e=await fetch(t,r)}catch(n){const u=n.message||n.toString()||String(n),k=n.name||"Error";if(k==="TypeError"&&(u.toLowerCase().includes("fetch")||u.toLowerCase().includes("network")||u.toLowerCase().includes("failed to fetch")||u.toLowerCase().includes("load failed"))||u.toLowerCase().includes("cors")||u.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:t,method:r.method||"GET",error:u,name:k});const x=new Error("[[error:no-connection]]");throw x.originalError=n,x}throw console.error("[API] Unexpected fetch error:",{url:t,method:r.method||"GET",error:u,name:k}),n}const{headers:c}=e;if(c.get("x-redirect"))return p({url:c.get("x-redirect"),...r});const s=c.get("content-type"),y=s&&s.startsWith("application/json");let o;if(r.method!=="HEAD")try{y?o=await e.json():o=await e.text()}catch(n){throw console.error("[API] Error parsing response:",{url:t,status:e.status,statusText:e.statusText,contentType:s,error:n.message}),new Error("[[error:invalid-json]]")}if(!e.ok){let n;throw o?y&&o.status&&o.status.message?n=o.status.message:typeof o=="string"?n=o:n=e.statusText||"Request failed":n=e.statusText||"Request failed",new Error(n)}return y&&o&&o.hasOwnProperty("status")&&o.hasOwnProperty("response")?o.response:o}function d(r,t,e){return a({url:r+(t&&Object.keys(t).length?"?"+$.param(t):"")},e)}function l(r,t,e){return a({url:r+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"HEAD"},e)}function f(r,t,e){return a({url:r,method:"POST",data:t,headers:{"x-csrf-token":config.csrf_token}},e)}function A(r,t,e){return a({url:r,method:"PATCH",data:t,headers:{"x-csrf-token":config.csrf_token}},e)}function C(r,t,e){return a({url:r,method:"PUT",data:t,headers:{"x-csrf-token":config.csrf_token}},e)}function L(r,t,e){return a({url:r,method:"DELETE",data:t,headers:{"x-csrf-token":config.csrf_token}},e)}}}]);
