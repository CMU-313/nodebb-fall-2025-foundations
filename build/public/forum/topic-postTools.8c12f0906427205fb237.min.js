"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,15794,21374,25432,34271,49897,57490,63154,99127],{8454:(j,U,i)=>{var E,P;E=[i(24962),i(96352),i(52473),i(17459),i(34342),i(49897),i(33530),i(29930),i(91749),i(30076)],P=function(b,W,M,A,R,w,C,l,g,N){const T={};let c=!1;T.init=function(s){c=!1,h(),m(s),b.addShareHandlers(ajaxify.data.titleRaw),R.addVoteHandler(),T.updatePostCount(ajaxify.data.postcount)};function h(){document.querySelector('[component="topic"]')&&$('[component="topic"]').on("show.bs.dropdown",'[component="post/tools"]',function(){const o=$(this),t=o.find(".dropdown-menu"),{top:e}=this.getBoundingClientRect();if(o.toggleClass("dropup",e>window.innerHeight/2),t.attr("data-loaded"))return;t.html(N.generatePlaceholderWave([3,5,9,7,10,"divider",10]));const n=o.parents("[data-pid]"),a=n.attr("data-pid"),v=parseInt(n.attr("data-index"),10);socket.emit("posts.loadPostTools",{pid:a},async(f,x)=>{if(f)return l.error(f);x.posts.display_move_tools=x.posts.display_move_tools&&v!==0;const D=await app.parseAndTranslate("partials/topic/post-menu-list",x),k=i(57576);t.attr("data-loaded","true").html(D),new k("[data-clipboard-text]"),g.fire("action:post.tools.load",{element:t})})})}T.toggle=function(s,o){const t=M.get("post","pid",s);t.find('[component="post/quote"], [component="post/bookmark"], [component="post/reply"], [component="post/flag"], [component="user/chat"]').toggleClass("hidden",o),t.find('[component="post/delete"]').toggleClass("hidden",o).parent().attr("hidden",o?"":null),t.find('[component="post/restore"]').toggleClass("hidden",!o).parent().attr("hidden",o?null:""),t.find('[component="post/purge"]').toggleClass("hidden",!o).parent().attr("hidden",o?null:""),T.removeMenu(t)},T.removeMenu=function(s){s.find('[component="post/tools"] .dropdown-menu').removeAttr("data-loaded").html("")},T.updatePostCount=function(s){M.get("topic/post-count").attr("title",s).html(N.humanReadableNumber(s)),W.setCount(s)};function m(s){const o=M.get("topic");G(),o.on("click",'[component="post/quote"]',function(){p($(this),s)}),o.on("click",'[component="post/reply"]',function(){d($(this),s)}),$(".topic").on("click",'[component="topic/reply"]',function(e){e.preventDefault(),d($(this),s)}),$(".topic").on("click",'[component="topic/reply-as-topic"]',function(){A.translate(`[[topic:link-back, ${ajaxify.data.titleRaw}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(e){g.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:e})})}),o.on("click",'[component="post/bookmark"]',function(){return u($(this),r($(this),"data-pid"))}),o.on("click",'[component="post/pin"]',function(){const e=r($(this),"data-pid");return w.put(`/posts/${encodeURIComponent(e)}/pin`,void 0,function(n){if(n)return l.error(n);g.fire("action:post.pinned",{pid:e})}),!1}),o.on("click",'[component="post/unpin"]',function(){const e=r($(this),"data-pid");return w.del(`/posts/${encodeURIComponent(e)}/pin`,void 0,function(n){if(n)return l.error(n);g.fire("action:post.unpinned",{pid:e})}),!1}),o.on("click",'[component="post/upvote"]',function(){return R.toggleVote($(this),".upvoted",1)}),o.on("click",'[component="post/downvote"]',function(){return R.toggleVote($(this),".downvoted",-1)}),o.on("click",'[component="post/vote-count"]',function(){R.showVotes(r($(this),"data-pid"))}),o.on("click",'[component="post/announce-count"]',function(){R.showAnnouncers(r($(this),"data-pid"))}),o.on("click",'[component="post/flag"]',function(){const e=r($(this),"data-pid");i.e(6574).then(function(){var n=[i(6574)];(function(a){a.showFlagModal({type:"post",id:e})}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/already-flagged"]',function(){const e=$(this).data("flag-id");i.e(6574).then(function(){var n=[i(6574)];(function(a){C.confirm("[[flags:modal-confirm-rescind]]",function(v){v&&a.rescind(e)})}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/flagUser"]',function(){const e=r($(this),"data-uid");i.e(6574).then(function(){var n=[i(6574)];(function(a){a.showFlagModal({type:"user",id:e})}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/flagResolve"]',function(){const e=$(this).attr("data-flagId");i.e(6574).then(function(){var n=[i(6574)];(function(a){a.resolve(e)}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/edit"]',function(){const e=$(this),n=parseInt(r(e,"data-timestamp"),10),a=parseInt(ajaxify.data.postEditDuration,10);t(a,n,"post-edit-duration-expired")&&g.fire("action:composer.post.edit",{pid:r(e,"data-pid")})}),config.enablePostHistory&&ajaxify.data.privileges["posts:history"]&&o.on("click",'[component="post/view-history"], [component="post/edit-indicator"]',function(){const e=$(this);i.e(92747).then(function(){var n=[i(92747)];(function(a){a.open(r(e,"data-pid"))}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/delete"]',function(){const e=$(this),n=parseInt(r(e,"data-timestamp"),10),a=parseInt(ajaxify.data.postDeleteDuration,10);t(a,n,"post-delete-duration-expired")&&S($(this))});function t(e,n,a){if(!ajaxify.data.privileges.isAdminOrMod&&e&&Date.now()-n>e*1e3){const v=Math.floor(e/86400),f=Math.floor(e%86400/3600),x=Math.floor(e%86400%3600/60),D=e%86400%3600%60;let k="[[error:"+a+", "+e+"]]";return v?f?k="[[error:"+a+"-days-hours, "+v+", "+f+"]]":k="[[error:"+a+"-days, "+v+"]]":f?x?k="[[error:"+a+"-hours-minutes, "+f+", "+x+"]]":k="[[error:"+a+"-hours, "+f+"]]":x&&(D?k="[[error:"+a+"-minutes-seconds, "+x+", "+D+"]]":k="[[error:"+a+"-minutes, "+x+"]]"),l.error(k),!1}return!0}o.on("click",'[component="post/restore"]',function(){S($(this))}),o.on("click",'[component="post/purge"]',function(){H($(this))}),o.on("click",'[component="post/move"]',function(){const e=$(this);i.e(90677).then(function(){var n=[i(90677)];(function(a){a.init(e.parents("[data-pid]"))}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/change-owner"]',function(){const e=$(this);Promise.all([i.e(20056),i.e(17205)]).then(function(){var n=[i(17205)];(function(a){a.init(e.parents("[data-pid]"))}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/manage-editors"]',function(){const e=$(this);Promise.all([i.e(20056),i.e(24459)]).then(function(){var n=[i(24459)];(function(a){a.init(e.parents("[data-pid]"))}).apply(null,n)}).catch(i.oe)}),o.on("click",'[component="post/resolved"]',function(){const e=$(this),n=r(e,"data-pid"),v=!(e.attr("data-resolved")==="true");w.put(`/posts/${n}/resolved`,{resolved:v}).then(()=>{e.attr("data-resolved",v);const f=e.find('[component="post/resolved/icon"]'),x=e.find('[component="post/resolved/text"]');v?(f.removeClass("fa-question-circle text-warning").addClass("fa-check-circle text-success"),x.text("Mark as Unresolved")):(f.removeClass("fa-check-circle text-success").addClass("fa-question-circle text-warning"),x.text("Mark as Resolved")),l.success(v?"Marked as resolved":"Marked as unresolved")}).catch(l.error)}),o.on("click",'[component="post/ban-ip"]',function(){const e=$(this).attr("data-ip");socket.emit("blacklist.addRule",e,function(n){if(n)return l.error(n);l.success("[[admin/manage/blacklist:ban-ip]]")})}),o.on("click",'[component="post/chat"]',function(){Q($(this))})}async function d(s,o){const t=await y();V(async function(){let e=await I(s);(r(s,"data-uid")==="0"||!r(s,"data-userslug"))&&(e="");const n=s.is('[component="post/reply"]')?r(s,"data-pid"):null,a=!n||!t.pid||n===t.pid;t.text&&a?(e=e||t.username,g.fire("action:composer.addQuote",{tid:o,pid:n,title:ajaxify.data.titleRaw,username:e,body:t.text,selectedPid:t.pid})):g.fire("action:composer.post.new",{tid:o,pid:n,title:ajaxify.data.titleRaw,body:e?e+" ":$('[component="topic/quickreply/text"]').val()||""})})}async function p(s,o){const t=await y();V(async function(){const e=await I(s),n=r(s,"data-pid");function a(f){g.fire("action:composer.addQuote",{tid:o,pid:n,username:e,title:ajaxify.data.titleRaw,text:f})}if(t.text&&n&&n===t.pid)return a(t.text);const{content:v}=await w.get(`/posts/${encodeURIComponent(n)}/raw`);a(v)})}async function y(){let s="",o,t="";const e=window.getSelection?window.getSelection():document.selection.createRange(),n=$('[component="post"] [component="post/content"]');let a;return n.each(function(v,f){e&&e.containsNode&&f&&e.containsNode(f,!0)&&(a=f)}),a&&e&&(s=e.toString(),o=$(a).parents('[component="post"]').attr("data-pid"),t=await I($(a))),{text:s,pid:o,username:t}}function u(s,o){const t=s.attr("data-bookmarked")==="false"?"put":"del";return w[t](`/posts/${encodeURIComponent(o)}/bookmark`,void 0,function(e){if(e)return l.error(e);const n=t==="put"?"bookmark":"unbookmark";g.fire(`action:post.${n}`,{pid:o})}),!1}function r(s,o){return s.parents("[data-pid]").attr(o)}function I(s){return new Promise(o=>{let t="";if(s.attr("component")==="topic/reply"){o(t);return}const e=s.parents("[data-pid]");if(e.length&&!e.hasClass("self-post")){Promise.all([i.e(53050),i.e(26174)]).then(function(){var n=[i(13230)];(function(a){t=a(e.attr("data-username"),!0),t||(e.attr("data-uid")!=="0"?t="[[global:former-user]]":t="[[global:guest]]"),t&&t!=="[[global:former-user]]"&&t!=="[[global:guest]]"&&(t="@"+t),o(t)}).apply(null,n)}).catch(i.oe);return}o(t)})}function S(s){const o=r(s,"data-pid"),e=M.get("post","pid",o).hasClass("deleted")?"restore":"delete";L(e,o)}function H(s){L("purge",r(s,"data-pid"))}async function L(s,o){({action:s}=await g.fire(`static:post.${s}`,{action:s,pid:o})),s&&C.confirm("[[topic:post-"+s+"-confirm]]",function(t){if(!t)return;const e=s==="purge"?"":"/state";w[s==="restore"?"put":"del"](`/posts/${encodeURIComponent(o)}${e}`).catch(l.error)})}function Q(s){const o=s.parents("[data-pid]");return i.e(92619).then(function(){var t=[i(92619)];(function(e){e.newChat(o.attr("data-uid"))}).apply(null,t)}).catch(i.oe),s.parents(".btn-group").find(".dropdown-toggle").click(),!1}function V(s){if(!parseInt(ajaxify.data.topicStaleDays,10))return s();const t=Math.min(Date.now()-1e3*60*60*24*ajaxify.data.topicStaleDays,864e13);if(c||ajaxify.data.lastposttime>=t)return s();C.dialog({title:"[[topic:stale.title]]",message:"[[topic:stale.warning]]",buttons:{reply:{label:"[[topic:stale.reply-anyway]]",className:"btn-link",callback:function(){c=!0,s()}},create:{label:"[[topic:stale.create]]",className:"btn-primary",callback:function(){A.translate(`[[topic:link-back, ${ajaxify.data.title}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(n){g.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:n,fromStaleTopic:!0})})}}}}).modal()}const Y=utils.debounce(J,250);function G(){ajaxify.data.privileges["topics:reply"]&&(g.onPage("action:posts.loaded",z),$(document).off("selectionchange"),$(document).on("selectionchange",function(){window.getSelection().toString()===""&&$('[component="selection/tooltip"]').addClass("hidden")}),$(document).on("selectionchange",Y))}function J(){window.getSelection().toString()===""||z()}async function z(){let s=$('[component="selection/tooltip"]');if(s.addClass("hidden"),s.attr("data-ajaxify")==="1"){s.remove();return}const o=window.getSelection();if(o.focusNode&&o.type==="Range"&&ajaxify.data.template.topic){const t=$(o.focusNode),e=$(o.anchorNode),n=e.parents("[data-pid]").attr("data-pid"),a=t.parents("[data-pid]").attr("data-pid");if(n!==a||!t.parents('[component="post/content"]').length||!e.parents('[component="post/content"]').length)return;const v=t.parents("[data-pid]"),f=o.getRangeAt(0);if(!v.length||f.collapsed)return;const x=f.getClientRects(),D=x[x.length-1];s.length||(s=await app.parseAndTranslate("partials/topic/selection-tooltip",ajaxify.data),$('[component="selection/tooltip"]').remove(),s.addClass("hidden").appendTo("body")),s.off("click").on("click",'[component="selection/tooltip/quote"]',function(){s.addClass("hidden"),p(v.find('[component="post/quote"]'),ajaxify.data.tid)}),s.removeClass("hidden"),$(window).one("action:ajaxify.start",function(){s.attr("data-ajaxify",1).addClass("hidden"),$(document).off("selectionchange",Y)});const k=s.outerWidth(!0);s.css({top:D.bottom+$(window).scrollTop(),left:k>D.width?D.left:D.left+D.width-k})}}function F(){if(ajaxify.data&&ajaxify.data.category)if(ajaxify.data.category.name.replace(/&amp;/g,"&")==="Comments & Feedback"){$(".resolved-tools").show();const o=$('[component="topic/resolved"]');if(o.length){const t=o.attr("data-resolved")==="true",e=o.find('[component="topic/resolved/icon"]'),n=o.find('[component="topic/resolved/text"]');t?(e.removeClass("fa-question-circle text-warning").addClass("fa-check-circle text-success"),n.text("Mark as Unresolved")):(e.removeClass("fa-check-circle text-success").addClass("fa-question-circle text-warning"),n.text("Mark as Resolved"))}else setTimeout(F,100)}else $(".resolved-tools").hide()}return $(document).ready(F),$(window).on("action:ajaxify.end",F),$(document).on("click",'[component="topic/resolved"]',function(){const s=$(this),o=ajaxify.data.mainPid,e=!(s.attr("data-resolved")==="true");w.put(`/posts/${o}/resolved`,{resolved:e}).then(()=>{s.attr("data-resolved",e);const n=s.find('[component="topic/resolved/icon"]'),a=s.find('[component="topic/resolved/text"]');e?(n.removeClass("fa-question-circle text-warning").addClass("fa-check-circle text-success"),a.text("Mark as Unresolved")):(n.removeClass("fa-check-circle text-success").addClass("fa-question-circle text-warning"),a.text("Mark as Resolved")),l.success(e?"Marked as resolved":"Marked as unresolved")}).catch(l.error)}),T}.apply(U,E),P!==void 0&&(j.exports=P)},24962:(j,U,i)=>{var E,P;E=[i(91749)],P=function(b){const W={},M=window.location.protocol+"//"+window.location.host;W.addShareHandlers=function(w){function C(l,g,N,T){return window.open(l,"_blank","width="+N+",height="+T+",scrollbars=no,status=no"),b.fire("action:share.open",{url:l,urlToPost:g}),!1}$("#content").off("shown.bs.dropdown",".share-dropdown").on("shown.bs.dropdown",".share-dropdown",function(){const l=$(this).find(".post-link");l.val(M+R($(this))),setTimeout(function(){l.putCursorAtEnd().select()},50)}),A(".post-link",function(l){return l.preventDefault(),!1}),A('[component="share/twitter"]',function(){const l=R($(this)),g=`https://twitter.com/intent/tweet?text=${encodeURIComponent(w)}&url=${encodeURIComponent(l)}`;return C(g,l,550,420)}),A('[component="share/facebook"]',function(){const l=R($(this)),g=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(l)}`;return C(g,l,626,436)}),A('[component="share/whatsapp"]',function(){const l=R($(this)),g=encodeURIComponent(w)+" - "+encodeURIComponent(l),N=config.useragent.isMobile?`whatsapp://send?text=${g}`:`https://wa.me/?text=${g}`;return C(N,l,626,436)}),A('[component="share/telegram"]',function(){const l=R($(this)),g=`https://t.me/share/url?text=${encodeURIComponent(w)}&url=${encodeURIComponent(l)}`;return C(g,l,626,436)}),A('[component="share/linkedin"]',function(){const l=R($(this)),g=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(l)}`;return C(g,l,626,436)}),b.fire("action:share.addHandlers",{openShare:C})};function A(w,C){$("#content").off("click",w).on("click",w,C)}function R(w){const C=parseInt(w.parents("[data-pid]").attr("data-pid"),10),l="/post"+(C?"/"+C:"");return M+config.relative_path+l}return W}.apply(U,E),P!==void 0&&(j.exports=P)},29869:j=>{j.exports=function(U,i,E){i.setGlobal("true",!0),i.setGlobal("false",!1);const P=24*60*60*1e3,b={displayMenuItem:M,buildMetaTag:A,buildLinkTag:R,stringify:w,escape:C,stripTags:l,buildCategoryIcon:g,buildCategoryLabel:N,generateCategoryBackground:T,generateChildrenCategories:c,generateTopicClass:h,membershipBtn:m,spawnPrivilegeStates:d,localeToHTML:p,renderTopicImage:y,renderDigestAvatar:u,userAgentIcons:r,buildAvatar:I,increment:S,generateWroteReplied:H,generateRepliedTo:L,generateWrote:Q,encodeURIComponent:V,isoTimeToLocaleString:Y,shouldHideReplyContainer:G,humanReadableNumber:J,formattedNumber:z,txEscape:F,generatePlaceholderWave:s,register:o,__escape:W};function W(t){return t}function M(t,e){const n=t.navigation[e];return!(!n||n.route.match("/users")&&t.user&&!t.user.privileges["view:users"]||n.route.match("/tags")&&t.user&&!t.user.privileges["view:tags"]||n.route.match("/groups")&&t.user&&!t.user.privileges["view:groups"])}function A(t){const e=t.name?'name="'+t.name+'" ':"",n=t.property?'property="'+t.property+'" ':"",a=t.content?'content="'+t.content.replace(/\n/g," ")+'" ':"";return"<meta "+e+n+a+`/>
	`}function R(t){const e=["link","rel","as","type","href","sizes","title","crossorigin"],[n,a,v,f,x,D,k,K]=e.map(B=>t[B]?`${B}="${t[B]}" `:"");return"<link "+n+a+v+f+D+k+x+K+`/>
	`}function w(t){return JSON.stringify(t).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function C(t){return U.escapeHTML(t)}function l(t){return U.stripHTMLTags(t)}function g(t,e,n){return t?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${n}" style="${T(t)} width:${e}; height: ${e}; font-size: ${parseInt(e,10)/2}px;">${t.icon?`<i class="fa fa-fw ${t.icon}"></i>`:""}</span>`:""}function N(t,e="a",n=""){if(!t)return"";const a=e==="a"?`href="${E}/category/${t.slug}"`:"";return`<${e} ${a} class="badge px-1 text-truncate text-decoration-none ${n}" style="color: ${t.color};background-color: ${t.bgColor};border-color: ${t.bgColor}!important; max-width: 70vw;">
			${t.icon&&t.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${t.icon}"></i>`:""}
			${t.name}
		</${e}>`}function T(t){if(!t)return"";const e=[];return t.bgColor&&(e.push("background-color: "+t.bgColor),e.push(`border-color: ${t.bgColor}!important`)),t.color&&e.push("color: "+t.color),t.backgroundImage&&(e.push("background-image: url("+t.backgroundImage+")"),t.imageClass&&e.push("background-size: "+t.imageClass)),e.join("; ")+";"}function c(t){let e="";return!t||!t.children||!t.children.length||(t.children.forEach(function(n){if(n&&!n.isSection){const a=n.link?n.link:E+"/category/"+n.slug;e+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+T(n)+'"><i class="fa fa-fw '+n.icon+'"></i></div><a href="'+a+'"><small>'+n.name+"</small></a></span>"}}),e=e&&'<span class="category-children">'+e+"</span>"),e}function h(t){return["locked","pinned","deleted","unread","scheduled"].filter(n=>!!t[n]).join(" ")}function m(t,e=""){return t.isMember&&t.name!=="administrators"?`<button class="btn btn-danger ${e}" data-action="leave" data-group="${t.displayName}" ${t.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:t.isPending&&t.name!=="administrators"?`<button class="btn btn-warning disabled ${e}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:t.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${t.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${t.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!t.disableJoinRequests&&t.name!=="administrators"?`<button class="btn btn-success ${e}" data-action="join" data-group="${t.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function d(t,e,n,a){const v=[];for(const[f,x]of Object.entries(n))v.push({name:f,state:x,type:a[f]});return v.map(function(f){const x=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],D=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],k=["groups:moderate"];let K=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];t===-1&&(K=K.slice(3));const B=e==="guests"&&(x.includes(f.name)||f.name.startsWith("groups:admin:"))||e==="spiders"&&!D.includes(f.name)||e==="fediverse"&&!K.includes(f.name)||e==="Global Moderators"&&k.includes(f.name);return`
				<td data-privilege="${f.name}" data-value="${f.state}" data-type="${f.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${B?' d-none"':""}" autocomplete="off" type="checkbox"${f.state?" checked":""}${B?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function p(t,e){return t=t||e||"en-GB",t.replace("_","-")}function y(t){return t.thumb?'<img src="'+t.thumb+'" class="img-circle user-img" title="'+t.user.displayname+'" />':'<img component="user/picture" data-uid="'+t.user.uid+'" src="'+t.user.picture+'" class="user-img" title="'+t.user.displayname+'" />'}function u(t){return t.teaser?t.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.teaser.user.picture+'" title="'+t.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.teaser.user["icon:text"]+"</div>":t.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.user.picture+'" title="'+t.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.user["icon:text"]+"</div>"}function r(t){let e="";switch(t.platform){case"Linux":e+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":e+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":e+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":e+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":e+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":e+='<i class="fa fa-fw fa-mobile"></i>';break;default:e+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(t.browser){case"Chrome":e+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":e+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":e+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":e+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":e+='<i class="fa fa-fw fa-edge"></i>';break;default:e+='<i class="fa fa-fw fa-question-circle"></i>';break}return e}function I(t,e,n,a,v){t||(t=this),a=a||"";const f=new Map([["title",t.displayname],["data-uid",t.uid],["class",`avatar ${a}${n?" avatar-rounded":""}`]]),x=[`--avatar-size: ${e};`],D=K=>Array.from(K).reduce((B,[X,Z])=>(B+=` ${X}="${Z}"`,B),"");let k="";return t.picture&&(k+=`<img${D(f)} alt="${t.displayname}" loading="lazy" component="${v||"avatar/picture"}" src="${t.picture}" style="${x.join(" ")}" onError="this.remove()" itemprop="image" />`),k+=`<span${D(f)} component="${v||"avatar/icon"}" style="${x.join(" ")} background-color: ${t["icon:bgColor"]}">${t["icon:text"]}</span>`,k}function S(t,e){return String(t+parseInt(e,10))}function H(t,e){return t.toPid?L(t,e):Q(t,e)}function L(t,e){const n=t.parent&&t.parent.displayname?t.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${t.timestamp<Date.now()-e*P?"on":"ago"}, ${t.toPid}, ${E}/post/${encodeURIComponent(t.toPid)}, ${n}, ${E}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function Q(t,e){return`[[topic:wrote-${t.timestamp<Date.now()-e*P?"on":"ago"}, ${E}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function V(t){return encodeURIComponent(t)}function Y(t,e="en-GB"){return new Date(t).toLocaleString([e],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function G(t){return!!(t.replies.count<=0||t.replies.hasSingleImmediateReply)}function J(t,e=1){return U.makeNumberHumanReadable(t,e)}function z(t){return U.addCommas(t)}function F(t){return String(t).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function s(t){return t.map(n=>n==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${n}"></div>
			</li>`).join("")}function o(){Object.keys(b).forEach(function(t){i.registerHelper(t,b[t])})}return b}},30076:(j,U,i)=>{var E,P;const b=i(29869);E=[i(77918),i(81335)],P=function(W,M){return b(W,M,config.relative_path)}.apply(U,E),P!==void 0&&(j.exports=P)},34342:(j,U,i)=>{var E,P;E=[i(52473),i(17459),i(49897),i(91749),i(33530),i(29930),i(89336)],P=function(b,W,M,A,R,w,C){const l={};let g={};l.addVoteHandler=function(){g={},N()&&(b.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',h),b.get("topic").on("mouseleave",'[data-pid] [component="post/vote-count"]',c)),b.get("topic").on("mouseenter",'[data-pid] [component="post/announce-count"]',h),b.get("topic").on("mouseleave",'[data-pid] [component="post/announce-count"]',c)};function N(){const{upvoteVisibility:d,privileges:p}=ajaxify.data;return p.isAdminOrMod||d==="all"||d==="loggedin"&&config.loggedIn}function T(){const{upvoteVisibility:d,downvoteVisibility:p,privileges:y}=ajaxify.data;return y.isAdminOrMod||d==="all"||p==="all"||(d==="loggedin"||p==="loggedin")&&config.loggedIn}function c(){const d=$(this),p=d.parents("[data-pid]").attr("data-pid"),y=C.Tooltip.getInstance(this);y&&(y.dispose(),d.attr("title","")),g[p]=!1}function h(){const d=$(this),y=d.parent().parents("[data-pid]").attr("data-pid");g[y]=!0;const u=C.Tooltip.getInstance(this);u&&(u.dispose(),d.attr("title",""));const r=d.attr("component")==="post/vote-count"?`/posts/${encodeURIComponent(y)}/upvoters`:`/posts/${encodeURIComponent(y)}/announcers/tooltip`;M.get(r,{},function(I,S){if(I)return w.error(I);g[y]&&S&&m(d,S)})}function m(d,p){function y(r){d.attr("title",r),new C.Tooltip(d,{container:"#content",html:!0}).show()}let u=p.usernames.filter(r=>r!=="[[global:former-user]]");u.length&&(u.length+p.otherCount>p.cutoff?(u=u.join(", ").replace(/,/g,"|"),W.translate("[[topic:users-and-others, "+u+", "+p.otherCount+"]]",function(r){r=r.replace(/\|/g,","),y(r)})):(u=u.join(", "),y(u)))}return l.toggleVote=function(d,p,y){const u=d.closest("[data-pid]"),I=u.find(p).length?"del":"put",S=u.attr("data-pid");return M[I](`/posts/${encodeURIComponent(S)}/vote`,{delta:y},function(H){if(H){if(!app.user.uid){ajaxify.go("login");return}return w.error(H)}A.fire("action:post.toggleVote",{pid:S,delta:y,unvote:I==="del"})}),!1},l.showVotes=function(d){T()&&M.get(`/posts/${encodeURIComponent(d)}/voters`,{},function(p,y){if(p)return w.error(p);app.parseAndTranslate("modals/votes",y,function(u){const r=R.dialog({title:"[[global:voters]]",message:u,className:"vote-modal",show:!0,onEscape:!0,backdrop:!0});r.on("click",function(){r.modal("hide")})})})},l.showAnnouncers=async function(d){const p=await M.get(`/posts/${encodeURIComponent(d)}/announcers`,{}).catch(r=>w.error(r)),y=await app.parseAndTranslate("modals/announcers",p),u=R.dialog({title:`[[topic:announcers-x, ${p.announceCount}]]`,message:y,className:"announce-modal",show:!0,onEscape:!0,backdrop:!0});u.on("click",function(){u.modal("hide")})},l}.apply(U,E),P!==void 0&&(j.exports=P)},49897:(j,U,i)=>{i.r(U),i.d(U,{del:()=>T,get:()=>w,head:()=>C,patch:()=>g,post:()=>l,put:()=>N});var E=i(91749),P=i.n(E),b=i(33530),W=i.n(b);const M=config.relative_path+"/api/v3";async function A(c,h){if(c.url=c.url.startsWith("/api")?config.relative_path+c.url:M+c.url,typeof h=="function"){R(c).then(m=>h(null,m),m=>{let d=m;m instanceof Error||(d=new Error(String(m)));const p=d.message||String(d);if(p&&!p.startsWith("[[error:")&&(p.toLowerCase()==="fetch failed"||p.toLowerCase()==="failed to fetch"||p.toLowerCase().includes("networkerror")||p.toLowerCase().includes("network")&&p.toLowerCase().includes("failed"))){const u=new Error("[[error:no-connection]]");u.originalError=d,d=u}h(d)});return}try{return await R(c)}catch(m){if(m.message==="A valid login session was not found. Please log in and try again."){const{url:d}=await(0,E.fire)("filter:admin.reauth",{url:"login"});return(0,b.confirm)("[[error:api.reauth-required]]",p=>{p&&ajaxify.go(d)})}throw m}}async function R(c){const{url:h}=c;delete c.url,c.headers||(c.headers={}),c.data&&!(c.data instanceof FormData)&&(c.data=JSON.stringify(c.data||{}),c.headers["content-type"]="application/json; charset=utf-8");try{({options:c}=await(0,E.fire)("filter:api.options",{options:c}))}catch(r){console.error("[API] Error in filter:api.options hook:",r)}c.data&&(c.body=c.data,delete c.data);let m;try{m=await fetch(h,c)}catch(r){const I=r.message||r.toString()||String(r),S=r.name||"Error";if(S==="TypeError"&&(I.toLowerCase().includes("fetch")||I.toLowerCase().includes("network")||I.toLowerCase().includes("failed to fetch")||I.toLowerCase().includes("load failed"))||I.toLowerCase().includes("cors")||I.toLowerCase().includes("networkerror")){console.error("[API] Network error:",{url:h,method:c.method||"GET",error:I,name:S});const L=new Error("[[error:no-connection]]");throw L.originalError=r,L}throw console.error("[API] Unexpected fetch error:",{url:h,method:c.method||"GET",error:I,name:S}),r}const{headers:d}=m;if(d.get("x-redirect"))return R({url:d.get("x-redirect"),...c});const p=d.get("content-type"),y=p&&p.startsWith("application/json");let u;if(c.method!=="HEAD")try{y?u=await m.json():u=await m.text()}catch(r){throw console.error("[API] Error parsing response:",{url:h,status:m.status,statusText:m.statusText,contentType:p,error:r.message}),new Error("[[error:invalid-json]]")}if(!m.ok){let r;throw u?y&&u.status&&u.status.message?r=u.status.message:typeof u=="string"?r=u:r=m.statusText||"Request failed":r=m.statusText||"Request failed",new Error(r)}return y&&u&&u.hasOwnProperty("status")&&u.hasOwnProperty("response")?u.response:u}function w(c,h,m){return A({url:c+(h&&Object.keys(h).length?"?"+$.param(h):"")},m)}function C(c,h,m){return A({url:c+(h&&Object.keys(h).length?"?"+$.param(h):""),method:"HEAD"},m)}function l(c,h,m){return A({url:c,method:"POST",data:h,headers:{"x-csrf-token":config.csrf_token}},m)}function g(c,h,m){return A({url:c,method:"PATCH",data:h,headers:{"x-csrf-token":config.csrf_token}},m)}function N(c,h,m){return A({url:c,method:"PUT",data:h,headers:{"x-csrf-token":config.csrf_token}},m)}function T(c,h,m){return A({url:c,method:"DELETE",data:h,headers:{"x-csrf-token":config.csrf_token}},m)}}}]);
